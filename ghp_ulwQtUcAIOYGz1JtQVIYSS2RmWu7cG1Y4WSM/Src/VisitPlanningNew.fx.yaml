VisitPlanningNew As screen:
    Fill: =RGBA(227, 228, 230, 0.57)
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: |-
        =Set(
            PlanVarDate1,
            Today()
        );
        ClearCollect(offlineLeadCollection,'Leads.S')

    "'Bottom Bar_15' As 'Bottom Bar'":
        Fill: =RGBA(255, 255, 255, 1)
        Height: =105
        Y: =1029

    Button37_1 As button:
        DisabledBorderColor: =RGBA(102, 182, 227, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.Disabled
        Fill: =RGBA(56, 96, 178, 1)
        FontWeight: =FontWeight.Semibold
        Height: =46
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        Size: =24
        Text: =""
        Width: =130
        X: =416
        Y: =139
        ZIndex: =2

    areaCmb_1 As combobox:
        AccessibleLabel: ="select area"
        BorderColor: =RGBA(219, 219, 219, 1)
        BorderStyle: =BorderStyle.None
        BorderThickness: =0
        ChevronBackground: =
        ChevronDisabledBackground: =RGBA(166, 166, 166, 1)
        ChevronDisabledFill: =RGBA(244, 244, 244, 1)
        ChevronFill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
        ChevronHoverBackground: =
        ChevronHoverFill: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        DisplayFields: =["areaName"]
        Height: =35
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(184, 0, 0, 0.1)
        InputTextPlaceholder: ="Select Area"
        IsSearchable: =false
        Items: |
            =AddColumns(UserAssignedAreas,"areaName", Area.'Area Name')
        PaddingLeft: =10
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(184, 0, 0, 1)
        SearchFields: =["areaName"]
        SearchItems: =[]
        SelectionFill: =RGBA(184, 0, 0, 1)
        SelectMultiple: =false
        Size: =14
        Width: =112
        X: =430
        Y: =142
        ZIndex: =3

    SearchBox_1 As text:
        AccessibleLabel: ="search"
        BorderColor: =RGBA(153, 207, 236, 1)
        Color: =RGBA(0, 0, 0, 1)
        Default: =""
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        FocusedBorderThickness: =1
        Height: =50
        HintText: ="Search by Lead, Account or Contact"
        HoverBorderColor: =RGBA(0, 0, 0, 1)
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(184, 0, 0, 0.1)
        PaddingLeft: =50
        PressedBorderColor: =
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =392
        X: =10
        Y: =139
        ZIndex: =4

    Icon15_1 As icon.Search:
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =30
        Icon: =Icon.Search
        PaddingBottom: =3
        PaddingLeft: =5
        Width: =30
        X: =17
        Y: =153
        ZIndex: =5

    "'Type Filter_1' As gallery.galleryHorizontal":
        AccessibleLabel: ="Dashboard Toptab_1"
        BorderColor: =RGBA(109, 109, 109, 1)
        BorderStyle: =BorderStyle.None
        Fill: =RGBA(0,0,0,0)
        FocusedBorderThickness: =1
        Height: =50
        Items: |-
            =Table(
                {
                    Title: "Leads",
                    Id:1
                },
                {
                    Title: "Accounts",
                    Id:2
                }
            )
        OnSelect: =
        ShowScrollbar: =false
        TabIndex: =0
        TemplatePadding: =2
        TemplateSize: =302
        Y: =81
        ZIndex: =6

        Rectangle3_23 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: |-
                =If(ThisItem.IsSelected, ColorValue("#A00002"), RGBA(103, 204, 107, 0.1))
            FocusedBorderThickness: =4
            Height: =46
            HoverFill: =RGBA(103, 204, 107, 0.28)
            OnSelect: =Select(Parent)
            PressedFill: =RGBA(103, 204, 107, 0.25)
            Visible: =false
            Width: =209
            ZIndex: =1

        Label2_54 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: |-
                =If(
                    ThisItem.IsSelected,
                    ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') 
                    //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //_VarGblAppColors.textbgbutton
                    ,
                    ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                    //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                )
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =43
            OnSelect: =
            Size: =18
            Text: =ThisItem.Title
            Width: =280
            X: =13
            Y: =3
            ZIndex: =3

        Rectangle32_1 As rectangle:
            BorderColor: =RGBA(0, 18, 107, 1)
            Fill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            Height: =2
            OnSelect: =Select(Parent)
            Visible: |-
                =If(
                    _VarActivePartyTypeID = ThisItem.Id,
                   true,false)
            Width: =180
            X: =60
            Y: =44
            ZIndex: =4

    "'Lead Gallery_7' As gallery.galleryVertical":
        AccessibleLabel: ="Order Gallery"
        BorderColor: =RGBA(0, 18, 107, 1)
        BorderStyle: =BorderStyle.None
        FocusedBorderThickness: =01
        Height: =785
        Items: |-
            =If(
                varCollectionEmpty = true,
                Filter(
                    offlineLeadCollection,
                    'Owning User'.'Primary Email'= User().Email
                 
                ),
                If(
                    varLeadFilter = true,
                    If(
                        'Sort gallery_8'.Selected.Title = "Newest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                  //  Filter(
                                        offlineLeadCollection,
                                       // owninguser.'Primary Email' = User().Email
                                       
                                   // ),
                                    Filter(
                                        offlineLeadCollection,
                                      //  owninguser.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                         'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
            
                                    )
                           ),
                                SearchBox_1.Text in 'Lead Name' //|| SearchBox_1.Text in zx_Party. //|| SearchBox_1.Text in Contact.'First Name' || //SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Created On',
                            SortOrder.Descending
                        ),
                        'Sort gallery_8'.Selected.Title = "Oldest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                   // Filter(
                                        offlineLeadCollection,
                                      //  owninguser.'Primary Email' = User().Email
                                  //  ),
                                    Filter(
                                        offlineLeadCollection,
                                        'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                    )
                                ),
                                SearchBox_1.Text in 'Lead Name' //|| SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in //Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Created On',
                            SortOrder.Ascending
                        ),
                        'Sort gallery_8'.Selected.Title = "Highest to Lowest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                   // Filter(
                                        offlineLeadCollection,
                                    //    owninguser.'Primary Email' = User().Email
                                   // ),
                                    Filter(
                                        offlineLeadCollection,
                                        'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                    )
                                ),
                                SearchBox_1.Text in 'Lead Name' //|| SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in //Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Created On',
                            SortOrder.Ascending
                        ),
                        'Sort gallery_8'.Selected.Title = "Lowest to Highest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                    Filter(
                                        offlineLeadCollection,
                                        'Owning User'.'Primary Email' = User().Email 
                                    ),
                                    Filter(
                                        offlineLeadCollection,
                                        'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                    )
                                ),
                                SearchBox_1.Text in 'Lead Name' //SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Created On',
                            SortOrder.Descending
                        )
                    ),
             // Custom filter data ---------------------------------------------------------------------
                    varLeadFilter = false,
                    If(
                        'Sort gallery_8'.Selected.Title = "Newest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                    Filter(
                                        colFilterLeadData,
                                       // 'Leads.S',
                                        'Owning User'.'Primary Email' = User().Email 
                                    ),
                                    Filter(
                                        colFilterLeadData,
                                       //'Leads.S',
                                        'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                    )
                                ),
                                SearchBox_1.Text in 'Lead Name'  //|| SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Created On',
                            SortOrder.Descending
                        ),
                        'Sort gallery_8'.Selected.Title = "Oldest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                    Filter(
                                        colFilterLeadData,
                                        'Owning User'.'Primary Email' = User().Email 
                                    ),
                                    Filter(
                                        colFilterLeadData,
                                        'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                    )
                                ),
                                SearchBox_1.Text in 'Lead Name' //|| SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Created On',
                            SortOrder.Ascending
                        ),
                        'Sort gallery_8'.Selected.Title = "Highest to Lowest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                    Filter(
                                        colFilterLeadData,
                                        'Owning User'.'Primary Email' = User().Email 
                                    ),
                                    Filter(
                                        colFilterLeadData,
                                        'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                    )
                                ),
                                SearchBox_1.Text in 'Lead Name' //|| SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Created On',
                            SortOrder.Descending
                        ),
                        'Sort gallery_8'.Selected.Title = "Lowest to Highest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                    Filter(
                                        colFilterLeadData,
                                        'Owning User'.'Primary Email' = User().Email 
                                    ),
                                    Filter(
                                        colFilterLeadData,
                                        'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                    )
                                ),
                                SearchBox_1.Text in 'Lead Name' //|| SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                           'Created On',
                            SortOrder.Ascending
                        )
                    )
                )
            )
        Layout: =Layout.Vertical
        ShowScrollbar: =false
        TabIndex: =0
        TemplateSize: =236
        Visible: =If('Type Filter_1'.Selected.Id=1, true, false)
        Width: =610
        X: =10
        Y: =268
        ZIndex: =7

        Button5_26 As button:
            BorderColor: =RGBA(219, 219, 219, 1)
            BorderThickness: =1
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Semibold
            Height: =236
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =Color.White
            OnSelect: |-
                =/*Navigate('Leads Detail Page',ScreenTransition.CoverRight);
                Set(varLeadData, ThisItem)*/
                 
            Size: =24
            Text: =""
            Width: =600
            ZIndex: =2

        Rectangle1_34 As rectangle:
            AccessibleLabel: ="Rectangle1_7"
            BorderColor: =RGBA(0, 18, 107, 1)
            Fill: =ColorValue( LookUp('Environment Variable Definitions', 'Display Name'="Common Primary Background").'Default Value')//_VarGblAppColors.PrimaryBg
            Height: =2
            OnSelect: |-
                =/*Navigate('Leads Detail Page',ScreenTransition.CoverRight);
                Set(varLeadData, ThisItem)*/
                 
            TabIndex: =0
            Width: ='Lead Gallery_7'.TemplateWidth
            Y: =74
            ZIndex: =3

        Body1_123 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderColor: =Color.Transparent
            FocusedBorderThickness: =0.1
            Font: =LookUp(c_EnvironmentVariable,'Display Name'="Common Heading Font").'Default Value'
            FontWeight: =FontWeight.Bold
            OnSelect: |-
                =/*Navigate(
                    'Leads Detail Page',
                    ScreenTransition.CoverRight
                );
                Set(
                    varLeadData,
                    ThisItem
                );
                If(
                    ThisItem.Party.'Customer Type' = 'Party Type Choices'.Retailer,
                    Set(
                        varSelectedRetailerAttachedDistributor,
                        LookUp(
                            OfflinePartiesCollection,
                            'Customer Code' = ThisItem.Party.'Customer Code'
                        ).'Attached Distributor'.'Parties (new_partiesid)'
                    );
                    ,
                    Set(
                        varSelectedRetailerAttachedDistributor,
                        Blank()
                    )
                );
                */
            Size: =16
            TabIndex: =0
            Text: =ThisItem.zx_leadname
            Tooltip: =
            Width: =222
            Wrap: =false
            X: =70
            Y: =5
            ZIndex: =5

        Button6_3 As button:
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            DisplayMode: =DisplayMode.View
            Fill: =ColorValue( LookUp('Environment Variable Definitions', 'Display Name'="Common Primary Background").'Default Value')//_VarGblAppColors.PrimaryBg
            FontWeight: =FontWeight.Semibold
            Height: =43
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: =Select(Parent)
            Size: =16
            Text: =ThisItem.zx_leadstage
            Width: =115
            X: =357
            Y: =10
            ZIndex: =19

        Circle12_4 As circle:
            AccessibleLabel: ="Text"
            BorderColor: =RGBA(102, 182, 227, 1)
            BorderThickness: =1
            DisplayMode: |-
                =DisplayMode.Edit
                /*If(
                    CountRows(
                        Filter(
                            OfflineVisitCollection,
                            Lead.'Lead Id' = ThisItem.'Lead Id' && 'Visit date' = DateValue(ClickedPlanVisitDate)
                        )
                    ) = 0,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )*/
            Fill: =RGBA(255, 255, 255, 1)
            Height: =43
            OnSelect: |-
                =/*If(
                    LookUp(
                        Attendances,
                        User.'Primary Email' = User().Email && Date = DateValue(Today())
                    ).'Attendance Type' = 'Attendance Type Choices'.Absent,
                    Notify(
                        "Cannot create visit on leave",
                        NotificationType.Error,
                        1000
                    ),
                    Set(
                        varShowPlanText,
                        ThisItem.'Lead Name'
                    );
                    Set(
                        varSelectTimeForVisit,
                        true
                    );
                    Set(
                        varSelectedLeadForPlanning,
                        ThisItem
                    )
                )*/
            TabIndex: =0
            Visible: =If('Type Filter_1'.Selected.Id=1, true, false)
            Width: =43
            X: =493
            Y: =10
            ZIndex: =23

        Group15_1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =23

            Circle12_5 As circle:
                AccessibleLabel: ="Text"
                BorderColor: =RGBA(0, 18, 107, 1)
                DisplayMode: |-
                    =DisplayMode.Edit
                    /*If(
                        CountRows(
                            Filter(
                                OfflineVisitCollection,
                                Lead.'Lead Id' = ThisItem.'Lead Id' && 'Visit date' = DateValue(ClickedPlanVisitDate)
                            )
                        ) = 0,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )*/
                Fill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                Height: =43
                OnSelect: |-
                    =/* 
                    Set(
                        varShowPlanText,
                        ThisItem.'Lead Name'
                    );
                    Set(
                        varSelectTimeForVisit,
                        true
                    );
                    
                    Set(varSelectedLeadForPlanning, ThisItem) 
                    */
                    If(
                        LookUp(
                            Attendances,
                            User.'Primary Email' = User().Email && Date = DateValue(Today())
                        ).'Attendance Type' = 'Attendance Type Choices'.Absent,
                        Notify(
                            "Cannot create visit on leave",
                            NotificationType.Error,
                            1000
                        ),
                        /*Set(
                            varShowPlanText,
                            ThisItem.'Lead Name'
                        );*/
                       /* Set(
                            varSelectTimeForVisit,
                            true
                        );*/
                        /*Set(
                            varSelectedLeadForPlanning,
                            ThisItem
                        )*/
                        Collect(
                            colAddLeadParty,
                            Filter(
                                colFilterLeadData,
                                zx_leadsid = ThisItem.zx_leadsid
                            )
                        )
                    )
                TabIndex: =0
                Visible: =If('Type Filter_1'.Selected.Id=1, true, false)
                Width: =43
                X: =548
                Y: =10
                ZIndex: =21

            Icon29_1 As icon.Add:
                AccessibleLabel: ="Text"
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(255, 255, 255, 1)
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(244, 244, 244, 1)
                DisplayMode: |-
                    =If(
                        CountRows(
                            Filter(
                                colAddLeadParty,
                                zx_leadsid = ThisItem.zx_leadsid
                            )
                        ) = 0,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                Height: =25
                Icon: |-
                    =If(
                        CountRows(
                            Filter(
                                colAddLeadParty,
                                zx_leadsid = ThisItem.zx_leadsid  //_varSelectedArea1.Area
                            )
                        ) = 0,
                       Icon.Add,
                       Icon.Check
                    )
                OnSelect: |-
                    =/* 
                    Set(
                        varShowPlanText,
                        ThisItem.'Lead Name'
                    );
                    Set(
                        varSelectTimeForVisit,
                        true
                    );
                    
                    Set(varSelectedLeadForPlanning, ThisItem) 
                    */
                    If(
                        LookUp(
                            Attendances,
                            User.'Primary Email' = User().Email && Date = DateValue(Today())
                        ).'Attendance Type' = 'Attendance Type Choices'.Absent,
                        Notify(
                            "Cannot create visit on leave",
                            NotificationType.Error,
                            1000
                        ),
                        /*Set(
                            varShowPlanText,
                            ThisItem.'Lead Name'
                        );*/
                        /*Set(
                            varSelectTimeForVisit,
                            true
                        );*/
                        /*Set(
                            varSelectedLeadForPlanning,
                            ThisItem
                        );*/
                        //Set(_varShowPopUpForVisit, true)
                        Set(
                            varSelectVisitForPlanning,
                            ThisItem
                        );
                        Collect(
                            colAddLeadParty,
                            Filter(
                                offlineLeadCollection,
                                zx_leadsid = ThisItem.zx_leadsid
                            )
                        )
                    )
                TabIndex: =0
                Visible: =If('Type Filter_1'.Selected.Id=1, true, false)
                Width: =25
                X: =557
                Y: =18
                ZIndex: =22

        Icon30_1 As icon.Phone:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(102, 182, 227, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =30
            Icon: =Icon.Phone
            OnSelect: =Select(Parent)
            PaddingLeft: =3
            PaddingRight: =3
            Width: =30
            X: =500
            Y: =17
            ZIndex: =24

        Circle12_6 As circle:
            AccessibleLabel: ="Text"
            BorderColor: =RGBA(102, 182, 227, 1)
            BorderThickness: =1
            DisplayMode: |-
                =DisplayMode.Edit
                /*If(
                    CountRows(
                        Filter(
                            OfflineVisitCollection,
                            Lead.'Lead Id' = ThisItem.'Lead Id' && 'Visit date' = DateValue(ClickedPlanVisitDate)
                        )
                    ) = 0,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )*/
            Fill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            Height: =45
            OnSelect: |-
                =
                true
            TabIndex: =0
            Visible: =If('Type Filter_1'.Selected.Id=1, true, false)
            Width: =45
            X: =11
            Y: =15
            ZIndex: =25

        Body1_125 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderColor: =Color.Transparent
            FocusedBorderThickness: =0.1
            Font: =LookUp(c_EnvironmentVariable,'Display Name'="Common Heading Font").'Default Value'
            Height: =35
            OnSelect: |-
                =/*Navigate(
                    'Leads Detail Page',
                    ScreenTransition.CoverRight
                );
                Set(
                    varLeadData,
                    ThisItem
                );
                If(
                    ThisItem.Party.'Customer Type' = 'Party Type Choices'.Retailer,
                    Set(
                        varSelectedRetailerAttachedDistributor,
                        LookUp(
                            OfflinePartiesCollection,
                            'Customer Code' = ThisItem.Party.'Customer Code'
                        ).'Attached Distributor'.'Parties (new_partiesid)'
                    );
                    ,
                    Set(
                        varSelectedRetailerAttachedDistributor,
                        Blank()
                    )
                );
                */
            Size: =16
            TabIndex: =0
            Text: =ThisItem.zx_name
            Tooltip: =
            Wrap: =false
            X: =70
            Y: =40
            ZIndex: =26

        Label56_1 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: =Text(ThisItem.createdon,"dd-mm-yyyy")
            X: =219
            Y: =36
            ZIndex: =27

        Label61_1 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Bold
            OnSelect: =Select(Parent)
            Text: =Left(Upper(ThisItem.zx_Party.'Customer Name'),2)
            Width: =40
            X: =17
            Y: =18
            ZIndex: =28

        Label62_6 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: |-
                ="Contact :"
            Width: =130
            X: =18
            Y: =76
            ZIndex: =29

        Label63_6 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: = ThisItem.Contact.'First Name'
            Width: =130
            X: =160
            Y: =76
            ZIndex: =30

        Label62_8 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: |-
                ="Assigned Date :"
            X: =18
            Y: =116
            ZIndex: =31

        Label63_8 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: =ThisItem.zx_assigndate
            Width: =130
            X: =160
            Y: =116
            ZIndex: =32

        Label62_10 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: |-
                ="Source :"
            X: =18
            Y: =156
            ZIndex: =33

        Label63_10 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: =ThisItem.zx_source
            Width: =130
            X: =160
            Y: =156
            ZIndex: =34

        Label62_7 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: |-
                ="Est.Value :"
            Width: =130
            X: =308
            Y: =76
            ZIndex: =35

        Label62_9 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: |-
                ="Est. Closure :"
            Width: =130
            X: =308
            Y: =116
            ZIndex: =36

        Label62_11 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: |-
                ="Meeting Date :"
            Width: =140
            X: =308
            Y: =156
            ZIndex: =37

        Label63_7 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: = ThisItem.zx_estimatedvalue
            Width: =130
            X: =438
            Y: =76
            ZIndex: =38

        Label63_9 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: = Text(ThisItem.zx_expectedclosuredate,"dd-mm-yyyy")
            Width: =130
            X: =438
            Y: =116
            ZIndex: =39

        Label63_11 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: = ""
            Width: =130
            X: =438
            Y: =156
            ZIndex: =40

    Sort_8 As icon.ArrowsUpDown:
        AccessibleLabel: ="open sort"
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =Color.Black
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =46
        Icon: =Icon.Sort
        OnSelect: =Set(varSort,!varSort)
        PaddingBottom: =5
        PaddingLeft: =5
        PaddingRight: =5
        PaddingTop: =5
        TabIndex: =0//-1
        Visible: =If('Type Filter_1'.Selected.Id=1, true, false)
        Width: =40
        X: =600
        Y: =143
        ZIndex: =9

    Filter_9 As icon.FilterFlat:
        AccessibleLabel: ="Open filters"
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =Color.Black
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =46
        Icon: =Icon.FilterFlat
        OnSelect: |+
            =Set(
                varPartyFilter,
                !varPartyFilter
            );
            
        PaddingBottom: =5
        PaddingLeft: =5
        PaddingRight: =5
        PaddingTop: =5
        TabIndex: =0//-1
        Visible: =If('Type Filter_1'.Selected.Id=1, true, false)
        Width: =40
        X: =560
        Y: =142
        ZIndex: =10

    Header_8 As Header:
        Fill: =RGBA(255, 255, 255, 1)
        ScreenName: ="Visit Planning"
        ZIndex: =14

    Icon7_4 As icon.ShoppingCart:
        AccessibleLabel: ="Cart"
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =43
        Icon: =Icon.ShoppingCart
        OnSelect: =Navigate(VisitPlanCart)
        PaddingBottom: =5
        PaddingLeft: =5
        PaddingRight: =5
        PaddingTop: =5
        TabIndex: =0
        Width: =44
        X: =557
        Y: =25
        ZIndex: =15

    Button4_4 As button:
        BorderThickness: =0
        Color: =RGBA(0, 0, 0, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        DisplayMode: =DisplayMode.View
        Fill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
        FontWeight: =FontWeight.Semibold
        Height: =30
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        OnSelect: =Navigate(VisitPlanCart)
        RadiusBottomLeft: =50
        RadiusBottomRight: =50
        RadiusTopLeft: =50
        RadiusTopRight: =50
        Size: =LookUp(c_EnvironmentVariable,'Display Name'="Text Regular Font Size").'Default Value'
        Text: =CountRows(colAddLeadParty)
        Width: =30
        X: =596
        Y: =17
        ZIndex: =16

    "'Sort grp_5' As group":
        Height: =5
        Width: =5
        X: =-224
        Y: =40
        ZIndex: =16

        Rectangle14_34 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            Fill: =Color.White
            Height: =327
            Visible: =If(varSort=true && 'Type Filter_1'.Selected.Id=1,true,false) 
            Width: =391
            X: =227
            Y: =330
            ZIndex: =8

        "'Sort gallery_8' As gallery.galleryVertical":
            AccessibleLabel: ="Sort by"
            Height: =268
            Items: |-
                =/*["Newest",
                "Highest to Lowest",
                "Lowest to Highest"]*/
                Table(
                    {Title: "Newest",
                    Icon: Icon.ArrowDown},
                    {Title: "Oldest",
                    Icon: Icon.ArrowUp},
                    {
                        Title: "Highest to Lowest",
                        Icon: Icon.ArrowDown
                    },
                    {
                        Title: "Lowest to Highest",
                        Icon: Icon.ArrowUp
                    }
                )
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TabIndex: =0//-1
            TemplateSize: =57
            Visible: =If(varSort=true && 'Type Filter_1'.Selected.Id=1,true,false) 
            Width: =391
            X: =227
            Y: =388
            ZIndex: =11

            Label28_9 As label:
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: |-
                    =If(
                        ThisItem.IsSelected,
                        ColorValue(
                            LookUp(
                                c_EnvironmentVariable,
                                'Display Name' = "Button Fill"
                            ).'Default Value'
                        )
                    )
                    //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' ), RGBA(0, 0, 0, 1))
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =01
                FontWeight: =FontWeight.Semibold
                Height: =53
                OnSelect: =Set(varSort,false)
                Size: =18
                TabIndex: =0//-1
                Text: =ThisItem.Title
                Width: =313
                X: =68
                Y: =4
                ZIndex: =1

            Icon19_9 As icon.ArrowUp:
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(244, 244, 244, 1)
                DisplayMode: =DisplayMode.View
                Height: =30
                Icon: =ThisItem.Icon
                OnSelect: =Select(Parent)
                Width: =30
                X: =27
                Y: =15
                ZIndex: =2

        Icon20_12 As icon.ArrowsUpDown:
            BorderColor: =RGBA(0, 18, 107, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            DisplayMode: =DisplayMode.View
            Height: =33
            Icon: =Icon.Sort
            Visible: =If(varSort=true && 'Type Filter_1'.Selected.Id=1,true,false) 
            Width: =30
            X: =372
            Y: =350
            ZIndex: =12

        Label29_37 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Bold
            Height: =44
            Size: =20
            Text: ="Sort By"
            Visible: =If(varSort=true && 'Type Filter_1'.Selected.Id=1,true,false) 
            Width: =272
            X: =274
            Y: =343
            ZIndex: =13

    DateFilter_1 As gallery.galleryHorizontal:
        AccessibleLabel: ="Date Gallery"
        BorderColor: =RGBA(230, 230, 230, 1)
        Height: =60
        Items: |-
            =ForAll(
                [
                    {
                        Title: "Yesterday",
                        Date: DateValue(PlanVarDate1) - 1
                    },
                    {
                        Title: "Today",
                        Date: DateValue(PlanVarDate1)
                    },
                    {
                        Title: "Tomorrow",
                        Date: DateValue(PlanVarDate1) + 1
                    }
                ],
                {Value: ThisRecord}
            )
        ShowScrollbar: =false
        TabIndex: =0
        TemplatePadding: =0
        TemplateSize: =DateFilter_1.Width / 3
        Width: =App.Width - 100
        X: =50
        Y: =199
        ZIndex: =17

        Button5_11 As button:
            BorderStyle: =BorderStyle.None
            Color: |-
                =If(ThisItem.Value.Date = clickedvisit_planning_date, Color.White,ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' ) 
                )
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: |-
                =If(ThisItem.Value.Date = clickedvisit_planning_date, ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                ,ColorValue( LookUp('Environment Variable Definitions', 'Display Name'="Common Primary Background").'Default Value')//_VarGblAppColors.PrimaryBg 
                )
            FontWeight: =FontWeight.Semibold
            Height: =50
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: |-
                =ColorFade(ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                , -20%)
            OnSelect: =Set(clickedvisit_planning_date, ThisItem.Value.Date)
            Size: =12
            Text: |-
                =If(
                    (ThisItem.Value.Date = Today() - 1) || (ThisItem.Value.Date = Today()) || (ThisItem.Value.Date = Today() + 1),
                    ThisItem.Value.Title & " (" & Text(
                        DateValue(ThisItem.Value.Date),
                        "mmm dd"
                    ) & ")",
                    Text(
                        DateValue(ThisItem.Value.Date),
                        "mmm dd"
                    )
                )
            Width: =170
            X: =5
            Y: =5
            ZIndex: =1

    PrevDateIcn_1 As icon.ChevronLeft:
        AccessibleLabel: ="Left Date Icon"
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =30
        Icon: =Icon.ChevronLeft
        OnSelect: =Set(PlanVarDate1, DateValue(PlanVarDate1) - 3)
        TabIndex: =0
        Width: =50
        Y: =214
        ZIndex: =18

    NextDateIcn_1 As icon.ChevronLeft:
        AccessibleLabel: ="Right Date Icon"
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =30
        Icon: =Icon.ChevronRight
        OnSelect: =Set(PlanVarDate1, DateValue(PlanVarDate1) + 3)
        TabIndex: =0
        Width: =50
        X: =590
        Y: =214
        ZIndex: =19

