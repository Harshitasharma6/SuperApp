VisitPlanningNew As screen:
    Fill: =RGBA(227, 228, 230, 0.57)
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: |-
        =
        Set(
            VarvisitDate,
            Today()
        );
        Set(
            Clickedvisitdate,
            Today()
        );
        
        
        Set(varCollectionEmpty,true);
        Set(mylead,1)

    "'Bottom Bar_15' As 'Bottom Bar'":
        Height: =105
        Y: =1029

    Button37_1 As button:
        DisabledBorderColor: =RGBA(102, 182, 227, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.Disabled
        Fill: =RGBA(56, 96, 178, 1)
        FontWeight: =FontWeight.Semibold
        Height: =46
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        Size: =24
        Text: =""
        Width: =130
        X: =416
        Y: =211
        ZIndex: =2

    areaCmb_1 As combobox:
        AccessibleLabel: ="select area"
        BorderColor: =RGBA(219, 219, 219, 1)
        BorderStyle: =BorderStyle.None
        BorderThickness: =0
        ChevronBackground: =
        ChevronDisabledBackground: =RGBA(166, 166, 166, 1)
        ChevronDisabledFill: =RGBA(244, 244, 244, 1)
        ChevronFill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
        ChevronHoverBackground: =
        ChevronHoverFill: |-
            =  ColorValue(
                    LookUp(
                        c_EnvironmentVariable,
                        'Display Name' = "Button Fill"
                    ).'Default Value'
                )
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        DisplayFields: =["areaName"]
        Height: =35
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =
        InputTextPlaceholder: ="Select Area"
        IsSearchable: =false
        Items: |
            =AddColumns(UserAssignedAreas,"areaName", Area.'Area Name')
        PaddingLeft: =10
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =
        SearchFields: =["areaName"]
        SearchItems: =[]
        SelectionFill: |-
            =  ColorValue(
                    LookUp(
                        c_EnvironmentVariable,
                        'Display Name' = "Button Fill"
                    ).'Default Value'
                )
        SelectMultiple: =false
        Size: =14
        Width: =112
        X: =430
        Y: =214
        ZIndex: =3

    SearchBox_1 As text:
        AccessibleLabel: ="search"
        BorderColor: =RGBA(153, 207, 236, 1)
        Color: =RGBA(0, 0, 0, 1)
        Default: =""
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        FocusedBorderThickness: =1
        Height: =50
        HintText: ="Search by Lead, Account or Contact"
        HoverBorderColor: =RGBA(0, 0, 0, 1)
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(184, 0, 0, 0.1)
        PaddingLeft: =50
        PressedBorderColor: =
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =392
        X: =10
        Y: =211
        ZIndex: =4

    Icon15_1 As icon.Search:
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =30
        Icon: =Icon.Search
        PaddingBottom: =3
        PaddingLeft: =5
        Width: =30
        X: =17
        Y: =225
        ZIndex: =5

    "'Type Filter_1' As gallery.galleryHorizontal":
        AccessibleLabel: ="Dashboard Toptab_1"
        BorderColor: =RGBA(109, 109, 109, 1)
        BorderStyle: =BorderStyle.None
        Fill: =RGBA(0,0,0,0)
        FocusedBorderThickness: =1
        Height: =50
        Items: |-
            =Table(
                {
                    Title: "Leads",
                    Id:1
                },
                {
                    Title: "Accounts",
                    Id:2
                }
            )
        OnSelect: =
        ShowScrollbar: =false
        TabIndex: =0
        TemplatePadding: =2
        TemplateSize: =302
        Y: =145
        ZIndex: =6

        Rectangle3_23 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: |-
                =If(ThisItem.IsSelected, ColorValue("#A00002"), RGBA(103, 204, 107, 0.1))
            FocusedBorderThickness: =4
            Height: =46
            HoverFill: =RGBA(103, 204, 107, 0.28)
            OnSelect: =Select(Parent)
            PressedFill: =RGBA(103, 204, 107, 0.25)
            Visible: =false
            Width: =209
            ZIndex: =1

        Label2_54 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: |-
                =If(
                    mylead = ThisItem.Id,
                
                
                    ColorValue(
                        LookUp(
                            c_EnvironmentVariable,
                            'Display Name' = "Button Fill"
                        ).'Default Value'
                    )
                    //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                    ,
                
                        ColorValue(
                        LookUp(
                            c_EnvironmentVariable,
                            'Display Name' = "Text Primary Color"
                        ).'Default Value'
                    )
                    //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //_VarGblAppColors.textbgbutton
                )
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =43
            OnSelect: =Set(mylead,ThisItem.Id)
            Size: =18
            Text: =ThisItem.Title
            Width: =280
            X: =13
            Y: =3
            ZIndex: =3

        Rectangle32_1 As rectangle:
            BorderColor: =RGBA(0, 18, 107, 1)
            Fill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            Height: =2
            OnSelect: =Select(Parent)
            Visible: |-
                =If(
                    mylead = ThisItem.Id,
                   true,false)
            Width: =180
            X: =60
            Y: =44
            ZIndex: =4

    "'Lead Gallery_7' As gallery.galleryVertical":
        AccessibleLabel: ="Order Gallery"
        BorderColor: =RGBA(0, 18, 107, 1)
        BorderStyle: =BorderStyle.None
        FocusedBorderThickness: =01
        Height: =785
        Items: |-
            =If(
                varCollectionEmpty = true,
                If(
                    IsBlank(areaCmb_1.Selected),
                    If(
                        IsBlank(SearchBox_1.Text),
                        Filter(
                            offlineLeadCollection,
                            'Owning User'.'Primary Email' = User().Email
                        ),
                        Filter(
                            Filter(
                                offlineLeadCollection,
                                'Owning User'.'Primary Email' = User().Email
                            ),
                            SearchBox_1.Text in 'Lead Id'
                        )
                    ),
                    If(
                        IsBlank(SearchBox_1.Text),
                        Filter(
                            offlineLeadCollection,
                            'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                        ),
                        Filter(
                            Filter(
                                offlineLeadCollection,
                                'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                            ),
                            SearchBox_1.Text in  'Lead Id'
                        )
                    )
                ),
                If(
                    varLeadFilter = true,
                    If(
                        'Sort gallery_8'.Selected.Title = "Newest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                  //  Filter(
                                    offlineLeadCollection,
                                       // 'Owning User'.'Primary Email' = User().Email
                                   // ),
                                    Filter(
                                        offlineLeadCollection,
                                      //  'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                        'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                    )
                                ),
                                SearchBox_1.Text in 'Lead Name'//|| SearchBox_1.Text in zx_Party. //|| SearchBox_1.Text in Contact.'First Name' || //SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Created On',
                            SortOrder.Descending
                        ),
                        'Sort gallery_8'.Selected.Title = "Oldest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                   // Filter(
                                    offlineLeadCollection,
                                      //  'Owning User'.'Primary Email' = User().Email
                                  //  ),
                                    Filter(
                                        offlineLeadCollection,
                                        'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                    )
                                ),
                                SearchBox_1.Text in 'Lead Name'//|| SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in //Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Created On',
                            SortOrder.Ascending
                        ),
                        'Sort gallery_8'.Selected.Title = "Highest to Lowest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                   // Filter(
                                    offlineLeadCollection,
                                    //    'Owning User'.'Primary Email' = User().Email
                                   // ),
                                    Filter(
                                        offlineLeadCollection,
                                        'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                    )
                                ),
                                SearchBox_1.Text in 'Lead Name'//|| SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in //Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Lead Value',
                            SortOrder.Ascending
                        ),
                        'Sort gallery_8'.Selected.Title = "Lowest to Highest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                    Filter(
                                        offlineLeadCollection,
                                        'Owning User'.'Primary Email' = User().Email
                                    ),
                                    Filter(
                                        offlineLeadCollection,
                                        'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                    )
                                ),
                                SearchBox_1.Text in 'Lead Name'//SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Lead Value',
                            SortOrder.Descending
                        )
                    ),
             // Custom filter data ---------------------------------------------------------------------
                    varLeadFilter = false,
                    If(
                        'Sort gallery_8'.Selected.Title = "Newest",
                        Sort(
                            If(
                                IsBlank(areaCmb_1.Selected),
                                Filter(
                                    colFilterLeadData,
                                       // 'Leads.S',
                                    'Owning User'.'Primary Email' = User().Email
                                ),
                                Filter(
                                    colFilterLeadData,
                                       //'Leads.S',
                                    'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                )
                                 //|| SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Created On',
                            SortOrder.Descending
                        ),
                        'Sort gallery_8'.Selected.Title = "Oldest",
                        Sort(
                            Filter(
                                If(
                                    IsBlank(areaCmb_1.Selected),
                                    Filter(
                                        colFilterLeadData,
                                        'Owning User'.'Primary Email' = User().Email
                                    ),
                                    Filter(
                                        colFilterLeadData,
                                        'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                    )
                                ),
                                SearchBox_1.Text in 'Lead Name'//|| SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Created On',
                            SortOrder.Ascending
                        ),
                        'Sort gallery_8'.Selected.Title = "Highest to Lowest",
                        Sort(
                            If(
                                IsBlank(areaCmb_1.Selected),
                                Filter(
                                    colFilterLeadData,
                                    'Owning User'.'Primary Email' = User().Email
                                ),
                                Filter(
                                    colFilterLeadData,
                                    'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                )
                              //|| SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Lead Value',
                            SortOrder.Descending
                        ),
                        'Sort gallery_8'.Selected.Title = "Lowest to Highest",
                        Sort(
                            If(
                                IsBlank(areaCmb_1.Selected),
                                Filter(
                                    colFilterLeadData,
                                    'Owning User'.'Primary Email' = User().Email
                                ),
                                Filter(
                                    colFilterLeadData,
                                    'Owning User'.'Primary Email' = User().Email && Area.Area = areaCmb_1.Selected.Area.Area
                                )
                               //|| SearchBox_1.Text in Party.'Customer Name' || SearchBox_1.Text in Contact.'First Name' || SearchBox_1.Text in Contact.'Last Name'
                            ),
                            'Lead Value',
                            SortOrder.Ascending
                        )
                    )
                )
            )
        Layout: =Layout.Vertical
        ShowScrollbar: =false
        TabIndex: =0
        TemplateSize: =236
        Visible: =If(mylead=1, true, false)
        Width: =610
        X: =10
        Y: =268
        ZIndex: =7

        Button5_26 As button:
            BorderColor: =RGBA(219, 219, 219, 1)
            BorderThickness: =1
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Semibold
            Height: =236
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =Color.White
            OnSelect: |-
                =/*Navigate('Leads Detail Page',ScreenTransition.CoverRight);
                Set(varLeadData, ThisItem)*/
                 
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Size: =24
            Text: =""
            Width: =600
            ZIndex: =2

        Rectangle1_34 As rectangle:
            AccessibleLabel: ="Rectangle1_7"
            BorderColor: =RGBA(0, 18, 107, 1)
            Fill: =ColorValue( LookUp('Environment Variable Definitions', 'Display Name'="Common Primary Background").'Default Value')//_VarGblAppColors.PrimaryBg
            Height: =2
            OnSelect: |-
                =/*Navigate('Leads Detail Page',ScreenTransition.CoverRight);
                Set(varLeadData, ThisItem)*/
                 
            TabIndex: =0
            Width: ='Lead Gallery_7'.TemplateWidth
            Y: =74
            ZIndex: =3

        Body1_123 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderColor: =Color.Transparent
            FocusedBorderThickness: =0.1
            Font: =LookUp(c_EnvironmentVariable,'Display Name'="Common Heading Font").'Default Value'
            FontWeight: =FontWeight.Bold
            OnSelect: |-
                =/*Navigate(
                    'Leads Detail Page',
                    ScreenTransition.CoverRight
                );
                Set(
                    varLeadData,
                    ThisItem
                );
                If(
                    ThisItem.Party.'Customer Type' = 'Party Type Choices'.Retailer,
                    Set(
                        varSelectedRetailerAttachedDistributor,
                        LookUp(
                            OfflinePartiesCollection,
                            'Customer Code' = ThisItem.Party.'Customer Code'
                        ).'Attached Distributor'.'Parties (new_partiesid)'
                    );
                    ,
                    Set(
                        varSelectedRetailerAttachedDistributor,
                        Blank()
                    )
                );
                */
            Size: =16
            TabIndex: =0
            Text: =ThisItem.'Lead Name'
            Tooltip: =
            Width: =222
            Wrap: =false
            X: =70
            Y: =5
            ZIndex: =5

        Button6_3 As button:
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            DisplayMode: =DisplayMode.View
            Fill: =ColorValue( LookUp('Environment Variable Definitions', 'Display Name'="Common Primary Background").'Default Value')//_VarGblAppColors.PrimaryBg
            FontWeight: =FontWeight.Semibold
            Height: =43
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: =Select(Parent)
            Size: =16
            Text: =ThisItem.zx_leadstage
            Width: =115
            X: =357
            Y: =10
            ZIndex: =19

        Circle12_4 As circle:
            AccessibleLabel: ="Text"
            BorderColor: =RGBA(102, 182, 227, 1)
            BorderThickness: =1
            DisplayMode: |-
                =DisplayMode.Edit
                /*If(
                    CountRows(
                        Filter(
                            OfflineVisitCollection,
                            Lead.'Lead Id' = ThisItem.'Lead Id' && 'Visit date' = DateValue(ClickedPlanVisitDate)
                        )
                    ) = 0,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )*/
            Fill: =RGBA(255, 255, 255, 1)
            Height: =43
            OnSelect: |-
                =/*If(
                    LookUp(
                        'Attendance.S',
                        User.'Primary Email' = User().Email && Date = DateValue(Today())
                    ).'Attendance Type' = 'Attendance Type Choices'.Absent,
                    Notify(
                        "Cannot create visit on leave",
                        NotificationType.Error,
                        1000
                    ),
                    Set(
                        varShowPlanText,
                        ThisItem.'Lead Name'
                    );
                    Set(
                        varSelectTimeForVisit,
                        true
                    );
                    Set(
                        varSelectedLeadForPlanning,
                        ThisItem
                    )
                )*/
            TabIndex: =0
            Visible: =If('Type Filter_1'.Selected.Id=1, true, false)
            Width: =43
            X: =493
            Y: =10
            ZIndex: =23

        Group15_1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =23

            Circle12_5 As circle:
                AccessibleLabel: ="Text"
                BorderColor: =RGBA(0, 18, 107, 1)
                DisplayMode: |-
                    =DisplayMode.Edit
                    /*If(
                        CountRows(
                            Filter(
                                OfflineVisitCollection,
                                Lead.'Lead Id' = ThisItem.'Lead Id' && 'Visit date' = DateValue(ClickedPlanVisitDate)
                            )
                        ) = 0,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )*/
                Fill: |-
                    =ColorValue(
                        LookUp(
                            c_EnvironmentVariable,
                            'Display Name' = "Button Fill"
                        ).'Default Value')
                    
                    
                    
                    //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                Height: =43
                OnSelect: |-
                    =/* 
                    Set(
                        varShowPlanText,
                        ThisItem.'Lead Name'
                    );
                    Set(
                        varSelectTimeForVisit,
                        true
                    );
                    
                    Set(varSelectedLeadForPlanning, ThisItem) 
                    */
                    If(
                        LookUp(
                            'Attendance.S',
                            User.'Primary Email' = User().Email && Date = DateValue(Today())
                        ).'Attendance Type' = 'Attendance Type Choices'.Absent,
                        Notify(
                            "Cannot create visit on leave",
                            NotificationType.Error,
                            1000
                        ),
                        /*Set(
                            varShowPlanText,
                            ThisItem.'Lead Name'
                        );*/
                       /* Set(
                            varSelectTimeForVisit,
                            true
                        );*/
                        /*Set(
                            varSelectedLeadForPlanning,
                            ThisItem
                        )*/
                        Collect(
                            colAddLeadParty,
                            Filter(
                                colFilterLeadData,
                                zx_leadsid = ThisItem.zx_leadsid
                            )
                        )
                    )
                TabIndex: =0
                Visible: |-
                    =If(
                        'Type Filter_1'.Selected.Id = 1 ,
                        true,
                        false
                    )
                Width: =43
                X: =548
                Y: =10
                ZIndex: =21

            Icon29_1 As icon.Add:
                AccessibleLabel: ="Text"
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(255, 255, 255, 1)
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(244, 244, 244, 1)
                DisplayMode: |-
                    =If(
                        CountRows(
                            Filter(
                                colAddLeadParty,
                                zx_leadsid = ThisItem.zx_leadsid
                            )
                        ) = 0,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                Height: =25
                Icon: |-
                    =
                    
                    If(
                        CountRows(
                            Filter(
                                colAddLeadParty,
                                zx_leadsid = ThisItem.zx_leadsid  //_varSelectedArea1.Area
                            )
                        ) = 0,
                     If(
                            CountRows(
                                Filter(
                                   'Visit.S',
                                     'Created By'.'Primary Email' = User().Email && 'Visit date' = Clickedvisitdate && Lead.Leads=ThisItem.Leads //_varSelectedArea1.Area
                                )
                            ) > 0,
                            Icon.Check,
                            Icon.Add
                     )
                       
                       ,
                       Icon.Check
                    )
                OnSelect: |-
                    =/* 
                    Set(
                        varShowPlanText,
                        ThisItem.'Lead Name'
                    );
                    Set(
                        varSelectTimeForVisit,
                        true
                    );
                    
                    Set(varSelectedLeadForPlanning, ThisItem) 
                    */
                    If(
                        LookUp(
                            'Attendance.S',
                            User.'Primary Email' = User().Email && Date = DateValue(Today())
                        ).'Attendance Type' = 'Attendance Type Choices'.Absent,
                        Notify(
                            "Cannot create visit on leave",
                            NotificationType.Error,
                            1000
                        ),
                        /*Set(
                            varShowPlanText,
                            ThisItem.'Lead Name'
                        );*/
                        /*Set(
                            varSelectTimeForVisit,
                            true
                        );*/
                        /*Set(
                            varSelectedLeadForPlanning,
                            ThisItem
                        );*/
                        //Set(_varShowPopUpForVisit, true)
                        Set(
                            varSelectVisitForPlanning,
                            ThisItem
                        );
                    
                    
                    If(Clickedvisitdate>=Today(),
                        If(
                            CountRows(
                                Filter(
                                    'Visit.S',
                                    'Created By'.'Primary Email' = User().Email && 'Visit date' = Clickedvisitdate && Lead.Leads = ThisItem.Leads//_varSelectedArea1.Area
                                )
                            ) > 0,
                            Notify("Visit is Already Created",NotificationType.Error,1000),
                            Collect(
                                colAddLeadParty,
                                Filter(
                                    offlineLeadCollection,
                                    zx_leadsid = ThisItem.zx_leadsid
                                )
                            )
                        ),
                        Notify("You can't plan a visit for yesterday",NotificationType.Error,1000))
                    
                    
                    )
                TabIndex: =0
                Visible: |-
                    =If(
                        'Type Filter_1'.Selected.Id = 1 ,
                        true,
                        false
                    )
                Width: =25
                X: =557
                Y: =18
                ZIndex: =22

        Icon30_1 As icon.Phone:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(102, 182, 227, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =30
            Icon: =Icon.Phone
            OnSelect: =Select(Parent)
            PaddingLeft: =3
            PaddingRight: =3
            Width: =30
            X: =500
            Y: =17
            ZIndex: =24

        Circle12_6 As circle:
            AccessibleLabel: ="Text"
            BorderColor: =RGBA(102, 182, 227, 1)
            BorderThickness: =1
            DisplayMode: |-
                =DisplayMode.Edit
                /*If(
                    CountRows(
                        Filter(
                            OfflineVisitCollection,
                            Lead.'Lead Id' = ThisItem.'Lead Id' && 'Visit date' = DateValue(ClickedPlanVisitDate)
                        )
                    ) = 0,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )*/
            Fill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            Height: =45
            OnSelect: |-
                =
                true
            TabIndex: =0
            Visible: =If('Type Filter_1'.Selected.Id=1, true, false)
            Width: =45
            X: =11
            Y: =15
            ZIndex: =25

        Body1_125 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderColor: =Color.Transparent
            FocusedBorderThickness: =0.1
            Font: =LookUp(c_EnvironmentVariable,'Display Name'="Common Heading Font").'Default Value'
            Height: =35
            OnSelect: |-
                =/*Navigate(
                    'Leads Detail Page',
                    ScreenTransition.CoverRight
                );
                Set(
                    varLeadData,
                    ThisItem
                );
                If(
                    ThisItem.Party.'Customer Type' = 'Party Type Choices'.Retailer,
                    Set(
                        varSelectedRetailerAttachedDistributor,
                        LookUp(
                            OfflinePartiesCollection,
                            'Customer Code' = ThisItem.Party.'Customer Code'
                        ).'Attached Distributor'.'Parties (new_partiesid)'
                    );
                    ,
                    Set(
                        varSelectedRetailerAttachedDistributor,
                        Blank()
                    )
                );
                */
            Size: =16
            TabIndex: =0
            Text: =ThisItem.zx_name
            Tooltip: =
            Wrap: =false
            X: =70
            Y: =40
            ZIndex: =26

        Label56_1 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: =Text(ThisItem.createdon,"dd-mm-yyyy")
            X: =219
            Y: =36
            ZIndex: =27

        Label61_1 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Bold
            OnSelect: =Select(Parent)
            Text: =Left(Upper(ThisItem.zx_Party.'Customer Name'),2)
            Width: =40
            X: =17
            Y: =18
            ZIndex: =28

        Label62_6 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: |-
                ="Contact :"
            Width: =130
            X: =18
            Y: =76
            ZIndex: =29

        Label63_6 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: = ThisItem.Contact.'First Name'
            Width: =130
            X: =160
            Y: =76
            ZIndex: =30

        Label62_8 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: |-
                ="Assigned Date :"
            X: =18
            Y: =116
            ZIndex: =31

        Label63_8 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: =ThisItem.zx_assigndate
            Width: =130
            X: =160
            Y: =116
            ZIndex: =32

        Label62_10 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: |-
                ="Source :"
            X: =18
            Y: =156
            ZIndex: =33

        Label63_10 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: =ThisItem.zx_source
            Width: =130
            X: =160
            Y: =156
            ZIndex: =34

        Label62_7 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: |-
                ="Est.Value :"
            Width: =130
            X: =308
            Y: =76
            ZIndex: =35

        Label62_9 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: |-
                ="Est. Closure :"
            Width: =130
            X: =308
            Y: =116
            ZIndex: =36

        Label62_11 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: |-
                ="Meeting Date :"
            Width: =140
            X: =308
            Y: =156
            ZIndex: =37

        Label63_7 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: = ThisItem.zx_estimatedvalue
            Width: =130
            X: =438
            Y: =76
            ZIndex: =38

        Label63_9 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: = Text(ThisItem.zx_expectedclosuredate,"dd-mm-yyyy")
            Width: =130
            X: =438
            Y: =116
            ZIndex: =39

        Label63_11 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            OnSelect: =Select(Parent)
            Text: = ""
            Width: =130
            X: =438
            Y: =156
            ZIndex: =40

    Sort_8 As icon.ArrowsUpDown:
        AccessibleLabel: ="open sort"
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: |-
            =
            
                ColorValue(
                    LookUp(
                        c_EnvironmentVariable,
                        'Display Name' = "Button Fill"
                    ).'Default Value'
                )
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =46
        Icon: =Icon.Sort
        OnSelect: =Set(varSort,!varSort)
        PaddingBottom: =5
        PaddingLeft: =5
        PaddingRight: =5
        PaddingTop: =5
        TabIndex: =0//-1
        Visible: =If('Type Filter_1'.Selected.Id=1, true, false)
        Width: =40
        X: =595
        Y: =210
        ZIndex: =9

    Header_8 As Header:
        ScreenName: ="Visit Planning"
        ZIndex: =13

    Icon7_4 As icon.ShoppingCart:
        AccessibleLabel: ="Cart"
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =43
        Icon: =Icon.ShoppingCart
        OnSelect: =Navigate(VisitPlanCart)
        PaddingBottom: =5
        PaddingLeft: =5
        PaddingRight: =5
        PaddingTop: =5
        TabIndex: =0
        Width: =44
        X: =557
        Y: =25
        ZIndex: =14

    Button4_4 As button:
        BorderThickness: =0
        Color: =RGBA(0, 0, 0, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        DisplayMode: =DisplayMode.View
        Fill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
        FontWeight: =FontWeight.Semibold
        Height: =30
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        OnSelect: =Navigate(VisitPlanCart)
        RadiusBottomLeft: =50
        RadiusBottomRight: =50
        RadiusTopLeft: =50
        RadiusTopRight: =50
        Size: =LookUp(c_EnvironmentVariable,'Display Name'="Text Regular Font Size").'Default Value'
        Text: =CountRows(colAddLeadParty)
        Width: =30
        X: =596
        Y: =17
        ZIndex: =15

    "'Sort grp_5' As group":
        Height: =5
        Width: =5
        X: =-224
        Y: =40
        ZIndex: =16

        Rectangle14_34 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            Fill: =Color.White
            Height: =327
            Visible: =If(varSort=true && 'Type Filter_1'.Selected.Id=1,true,false) 
            Width: =391
            X: =227
            Y: =330
            ZIndex: =8

        "'Sort gallery_8' As gallery.galleryVertical":
            AccessibleLabel: ="Sort by"
            Height: =268
            Items: |-
                =/*["Newest",
                "Highest to Lowest",
                "Lowest to Highest"]*/
                Table(
                    {Title: "Newest",
                    Icon: Icon.ArrowDown},
                    {Title: "Oldest",
                    Icon: Icon.ArrowUp},
                    {
                        Title: "Highest to Lowest",
                        Icon: Icon.ArrowDown
                    },
                    {
                        Title: "Lowest to Highest",
                        Icon: Icon.ArrowUp
                    }
                )
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TabIndex: =0//-1
            TemplateSize: =57
            Visible: =If(varSort=true && 'Type Filter_1'.Selected.Id=1,true,false) 
            Width: =391
            X: =227
            Y: =388
            ZIndex: =10

            Label28_9 As label:
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: |-
                    =If(
                        ThisItem.IsSelected,
                        ColorValue(
                            LookUp(
                                c_EnvironmentVariable,
                                'Display Name' = "Button Fill"
                            ).'Default Value'
                        )
                    )
                    //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' ), RGBA(0, 0, 0, 1))
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =01
                FontWeight: =FontWeight.Semibold
                Height: =53
                OnSelect: =Set(varSort,false)
                Size: =18
                TabIndex: =0//-1
                Text: =ThisItem.Title
                Width: =313
                X: =68
                Y: =4
                ZIndex: =1

            Icon19_9 As icon.ArrowUp:
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(244, 244, 244, 1)
                DisplayMode: =DisplayMode.View
                Height: =30
                Icon: =ThisItem.Icon
                OnSelect: =Select(Parent)
                Width: =30
                X: =27
                Y: =15
                ZIndex: =2

        Icon20_12 As icon.ArrowsUpDown:
            BorderColor: =RGBA(0, 18, 107, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            DisplayMode: =DisplayMode.View
            Height: =33
            Icon: =Icon.Sort
            Visible: =If(varSort=true && 'Type Filter_1'.Selected.Id=1,true,false) 
            Width: =30
            X: =372
            Y: =350
            ZIndex: =11

        Label29_37 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Bold
            Height: =44
            Size: =20
            Text: ="Sort By"
            Visible: =If(varSort=true && 'Type Filter_1'.Selected.Id=1,true,false) 
            Width: =272
            X: =274
            Y: =343
            ZIndex: =12

    Gallery1_5 As gallery.galleryVertical:
        AccessibleLabel: ="List View"
        BorderColor: =RGBA(0, 18, 107, 1)
        FocusedBorderThickness: =
        Height: =768
        Items: =Filter(OfflinePartiesCollection,Area.Area=areaCmb_1.Selected.Area.Area)
        Layout: =Layout.Vertical
        ShowScrollbar: =false
        TabIndex: =
        TemplatePadding: =10
        TemplateSize: =226
        Visible: =If('Type Filter_1'.Selected.Id=2,true,false)
        Width: =630
        X: =10
        Y: =261
        ZIndex: =19

        Background_14 As button:
            BorderThickness: =0//1
            Color: |
                =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Hover Color").'Default Value')
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Hover Color").'Default Value')
            DisplayMode: =DisplayMode.Disabled
            Fill: =RGBA(56, 96, 178, 1)
            FontWeight: =FontWeight.Semibold
            Height: =215
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: |-
                =Navigate(
                    'Customer 360 Screen',
                    ScreenTransition.CoverRight
                );
                Set(
                    varCustomerRecord,
                    ThisItem
                )
            RadiusBottomLeft: =15
            RadiusBottomRight: =15
            RadiusTopLeft: =15
            RadiusTopRight: =15
            Size: =24
            Text: =""
            Width: =600
            ZIndex: =1

        TitleLbl_9 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderColor: =Color.Transparent
            FocusedBorderThickness: =01
            Font: =LookUp(c_EnvironmentVariable,'Display Name'="Common Heading Font").'Default Value'
            FontWeight: =FontWeight.Bold
            Height: =30
            OnSelect: |-
                =Navigate('Customer 360 Screen',ScreenTransition.CoverRight);
                
                Set(varCustomerRecord,ThisItem)
            Size: =LookUp(c_EnvironmentVariable,'Display Name'="Text Sub Title Font Size").'Default Value' // LookUp('Environment Variable Definitions', 'Display Name'="Text Sub Title Font Size").'Default Value'
            TabIndex: =0
            Text: =ThisItem.zx_name 
            Width: =300
            X: =70
            Y: =15
            ZIndex: =2

        Title2Lbl_7 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //_VarGblAppColors.textbgbutton
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =01
            Height: =30
            OnSelect: |-
                =Navigate('Customer 360 Screen',ScreenTransition.CoverRight);
                
                Set(varCustomerRecord,ThisItem)
            Size: =LookUp(c_EnvironmentVariable,'Display Name'="Text Regular Font Size").'Default Value'
            TabIndex: =0
            Text: =ThisItem.Area.'Area Name'
            Width: =545
            Wrap: =false
            X: =65
            Y: =38
            ZIndex: =3

        Rectangle1_7 As rectangle:
            AccessibleLabel: ="Rectangle1_6"
            BorderColor: =RGBA(0, 18, 107, 1)
            Fill: =RGBA(202, 202, 202, 1)
            Height: =1
            OnSelect: |-
                =Navigate('Customer 360 Screen',ScreenTransition.CoverRight);
                
                Set(varCustomerRecord,ThisItem)
            TabIndex: =0
            Width: =Gallery1_5.TemplateWidth
            Y: =78
            ZIndex: =4

        Body1_29 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =01
            Height: =33
            OnSelect: |-
                =Navigate('Customer 360 Screen',ScreenTransition.CoverRight);
                
                Set(varCustomerRecord,ThisItem)
            TabIndex: =0
            Text: |-
                ="Account No : "
            Width: =140
            Wrap: =false
            X: =18
            Y: =91
            ZIndex: =5

        Body1Value_14 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =01
            Height: =33
            OnSelect: |-
                =Navigate('Customer 360 Screen',ScreenTransition.CoverRight);
                
                Set(varCustomerRecord,ThisItem)
            TabIndex: =0
            Text: |-
                ="Phone: " 
            Width: =180
            Wrap: =false
            X: =320
            Y: =Body1_29.Y
            ZIndex: =8

        Body1_30 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =01
            Height: =33
            OnSelect: |-
                =Navigate('Customer 360 Screen',ScreenTransition.CoverRight);
                
                Set(varCustomerRecord,ThisItem)
            TabIndex: =0
            Text: |-
                ="Last Visit Date :"
            X: =18
            Y: =Body1_29.Y+Body1_29.Height
            ZIndex: =14

        Body1_31 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //_VarGblAppColors.textbgbutton
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =01
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =33
            OnSelect: |-
                =Navigate('Customer 360 Screen',ScreenTransition.CoverRight);
                
                Set(varCustomerRecord,ThisItem)
            TabIndex: =0
            Text: |-
                =/*Text(
                    LookUp(
                        Visits,
                        Party.'Customer Code' = ThisItem.'Customer Code'
                    ).'Visit date',
                    "dd/mm/yyyy"
                );*/
                Text(
                    LookUp(
                        Sort(
                           OfflineVisitCollection,
                            zx_visitdate,
                            SortOrder.Descending
                        ),
                        zx_Party.Parties = ThisItem.zx_partiesid && 'Visit Status' = [@'Visit Status'].Completed
                        
                    ).zx_visitdate,
                    "dd/mm/yyyy"
                )
            Width: =137
            X: =155
            Y: =Body1_29.Y+Body1_29.Height
            ZIndex: =15

        Body1_32 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =01
            Height: =33
            OnSelect: |-
                =Navigate('Customer 360 Screen',ScreenTransition.CoverRight);
                
                Set(varCustomerRecord,ThisItem)
            TabIndex: =0
            Text: |-
                ="Last Order Date :"
            Width: =170
            X: =18
            Y: =Body1_30.Y+Body1_30.Height
            ZIndex: =16

        Body1_33 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //_VarGblAppColors.textbgbutton
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =01
            Font: =LookUp(c_EnvironmentVariable,'Display Name'="Common Heading Font").'Default Value'
            FontWeight: =FontWeight.Semibold
            Height: =33
            OnSelect: |-
                =Navigate('Customer 360 Screen',ScreenTransition.CoverRight);
                
                Set(varCustomerRecord,ThisItem)
            Size: |-
                =//LookUp(c_EnvironmentVariable,'Display Name'="Text Regular Font Size").'Default Value'
                14
            TabIndex: =0
            Text: |-
                =If(
                    IsBlank(
                        LookUp(
                            OfflineOrderHeaderCollection,
                            'Order From'.'Customer Code' = ThisItem.zx_customercode
                        ).'Created On'
                    ),
                    "NA",
                    Text(
                        LookUp(Sort(OfflineOrderHeaderCollection,'Created On',SortOrder.Descending)
                            ,
                            'Order From'.'Customer Code' = ThisItem.zx_customercode
                        ).'Created On',
                        "dd/mm/yyyy"
                    )
                )
            Width: =140
            X: =170
            Y: =Body1_30.Y+Body1_30.Height
            ZIndex: =17

        Body1_34 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =01
            Height: =33
            OnSelect: |-
                =Navigate('Customer 360 Screen',ScreenTransition.CoverRight);
                
                Set(varCustomerRecord,ThisItem)
            TabIndex: =0
            Text: |-
                ="Last Order Value :"
            Width: =180
            X: =320
            Y: =Body1_30.Y+Body1_30.Height
            ZIndex: =18

        Body1_35 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //_VarGblAppColors.textbgbutton
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =01
            Font: =LookUp(c_EnvironmentVariable,'Display Name'="Common Heading Font").'Default Value'
            FontWeight: =FontWeight.Semibold
            Height: =33
            OnSelect: |-
                =Navigate('Customer 360 Screen',ScreenTransition.CoverRight);
                
                Set(varCustomerRecord,ThisItem)
            Size: |
                =//LookUp(c_EnvironmentVariable,'Display Name'="Text Regular Font Size").'Default Value'
                14
            TabIndex: =0
            Text: |-
                =If(
                    IsBlank(
                        Text(
                          //  Round(
                                LookUp(
                                    OfflineOrderHeaderCollection,
                                    'Order From'.'Customer Code' = ThisItem.zx_customercode
                                ).'Total Bill Amount',
                              //  2
                         //   ),
                            "[$-en-US]0.00"
                        )
                    ),
                    "NA",
                    "₹" & LookUp(
                        Sort(
                            OfflineOrderHeaderCollection,
                            'Created On',
                            SortOrder.Descending
                        ),
                        'Order From'.Parties = ThisItem.zx_partiesid
                    ).'Total Bill Amount'
                )
            Width: =130
            X: =480
            Y: =Body1_30.Y+Body1_30.Height
            ZIndex: =19

        Label50_2 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //_VarGblAppColors.textbgbutton
            DisabledColor: =RGBA(166, 166, 166, 1)
            Height: =33
            OnSelect: =Select(Parent)
            Size: =21
            Text: |-
                =//ThisItem.'Meeting Date'
                ThisItem.zx_meetingdate
            Width: =151
            X: =450
            Y: =Body1_29.Y+Body1_29.Height
            ZIndex: =23

        Label51_4 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //_VarGblAppColors.textbgbutton
            DisabledColor: =RGBA(166, 166, 166, 1)
            Height: =33
            OnSelect: =Select(Parent)
            Text: = ThisItem.zx_customercode
            Width: =140
            X: =140
            Y: =Body1_29.Y
            ZIndex: =24

        Label51_5 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Text Primary Color").'Default Value') //_VarGblAppColors.textbgbutton
            DisabledColor: =RGBA(166, 166, 166, 1)
            Height: =33
            OnSelect: =Select(Parent)
            Text: = ThisItem.zx_mobileno
            Width: =140
            X: =386
            Y: =Body1_29.Y
            ZIndex: =25

        Group16_2 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =26

            Circle9_2 As circle:
                BorderColor: =RGBA(0, 18, 107, 1)
                Fill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                Height: =40
                OnSelect: =Select(Parent)
                Width: =40
                X: =24
                Y: =20
                ZIndex: =20

            Label49_2 As label:
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(255, 255, 255, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FontWeight: =FontWeight.Semibold
                Height: =35
                OnSelect: =Select(Parent)
                Text: =Left(Upper(ThisItem.zx_customertype),2)
                Width: =35
                X: =29
                Y: =23
                ZIndex: =21

    Container5_3 As groupContainer.manualLayoutContainer:
        Height: =860
        Visible: =varPartyFilter
        Width: =640
        Y: =193
        ZIndex: =22

        "'filter button_13' As button":
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Semibold
            Height: =840
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =25
            RadiusTopRight: =25
            Size: =24
            Text: =""
            Visible: =varPartyFilter
            Width: =640
            ZIndex: =1

        Container4_37 As groupContainer:
            ContentLanguage: =
            Height: =853
            Visible: =varPartyFilter
            Width: =640
            ZIndex: =2

            Rectangle16_12 As rectangle:
                BorderColor: =RGBA(0, 18, 107, 1)
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 1)
                Height: =450
                Visible: =varPartyFilter
                Width: =2
                X: =290
                Y: =198
                ZIndex: =1

            Label8_17 As label:
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FontWeight: =FontWeight.Bold
                Height: =58
                PaddingLeft: =30
                Size: =21
                Text: ="All Filters"
                Visible: =varPartyFilter
                Width: =273
                X: =20
                Y: =20
                ZIndex: =2

            btnLeadFilter_4 As button:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderThickness: =0
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                FocusedBorderThickness: =
                FontWeight: =FontWeight.Bold
                Height: =61
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: |-
                    =ColorFade(
                        ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                        , 10%)
                OnSelect: |
                    =ClearCollect(
                        colFilterLeadData,
                        If(
                            // Filter according to lead value---------------------------------------------------------
                            !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioStage_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_leadvalue = Value(Value(Leadvalue_2.Text)) && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Customer--------------------------------------------------------
                            !IsBlank(radioCustomers_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioStage_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage--------------------------------------------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                          
                            Filter(
                                offlineLeadCollection,
                              zx_leadstage = radioStage_2.Selected.Value && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to commit--------------------------------------------------------
                            !IsBlank(radioCommit_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioStage_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Area--------------------------------------------------------
                            !IsBlank(radioArea_3.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioStage_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Competitor--------------------------------------------------------
                            !IsBlank(radioCompetitor_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioStage_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to created date--------------------------------------------------------
                            !IsBlank(DateFrom_11.SelectedDate) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioStage_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || varEstimated = true,
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to expected closure date --------------------------------------------------------
                            !IsBlank(DateFrom_12.SelectedDate) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioStage_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(zx_expectedclosuredate) <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage and commit--------------------------------------------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && 'Owning User'.'Primary Email' = User().Email
                            ),
                             // Filter according to Stage and Created date------------------------------------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage and Lead value------------------------------------------------
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_leadvalue = Value(Leadvalue_2.Text) && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage and Estimated closure date-------------------------------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && DateValue(zx_expectedclosuredate) <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                             // Filter according to Stage and Customer-------------------------------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage and Area-------------------------------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage and Competitor-------------------------------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage,commit and created date--------------------------------------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                             // Filter according to Stage,commit and Lead Value--------------------------------------------------
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && zx_leadvalue = Value(Leadvalue_2.Text) && 'Owning User'.'Primary Email' = User().Email
                            ),
                                // Filter according to Stage,commit and Estimated closure date --------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(zx_expectedclosuredate) <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Stage,commit and Customer --------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage,commit and Area --------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage,commit and Competitor --------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Stage,commit,created date and lead value--------------------------------------------
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Stage,commit,created date and estimated date------------------------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage,commit,created date and Customer------------------------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                             // Filter according to Stage,commit,created date and Area------------------------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage,commit,created date and Competitor------------------------------------
                            !IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Stage,commit,created date,lead value and estimated----------------------------------
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Stage,commit,created date,lead value and Customer--------------------------------
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage,commit,created date,lead value and Area--------------------------------
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Stage,commit,created date,lead value and Competitor--------------------------------
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Stage,commit,created date,lead value, estimated and customer
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Stage,commit,created date,lead value,estimated and Competitor-------------------------
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Stage,commit,created date,lead value,estimated and Area-------------------------
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Stage,commit,created date,lead value, estimated,customer and area
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Stage,commit,created date,lead value, estimated,customer and Competitor
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Stage,commit,created date,lead value, estimated,customer,area and Competitor
                            !IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadstage = radioStage_2.Selected.Value && zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to commit and created date--------------------------------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to commit and lead value--------------------------------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && zx_leadvalue = Value(Leadvalue_2.Text) && 'Owning User'.'Primary Email' = User().Email
                            ),
                        // Filter according to commit and estimated--------------------------------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to commit and Customer--------------------------------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to commit and area--------------------------------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to commit and Competitor--------------------------------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to commit,created date,lead value-----------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to commit,created date, estimated----------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to commit,created date,customer----------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to commit,created date,area -----------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to commit,created date, Competitor-------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to commit,created date,lead value, estimated-----------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to commit,created date,lead value, customer------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to commit,created date,lead value, area --------------------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to commit,created date,lead value,  Competitor
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to commit,created date,lead value, estimated and customer-----------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to commit,created date,lead value, estimated and Area-----------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to commit,created date,lead value, estimated and Competitor-----------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to commit,created date,lead value, estimated,customer,area----
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                        // Filter according to commit,created date,lead value, estimated,customer,Competitor----
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to commit,created date,lead value, estimated,customer,area and Competitor
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && !IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_commited = radioCommit_2.Selected.Value && DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Created date and lead value------------------------------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Created date and estimated------------------------------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Created date and customer------------------------------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Created date and area------------------------------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                             // Filter according to Created date and Competitor------------------------------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Created date,lead value and estimated date--------------------------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Created date,lead value and Customer-----------------------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                        // Filter according to Created date,lead value and Area-----------------------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                        // Filter according to Created date,lead value and Competitor-----------------------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Created date,lead value,estimated date and customer----------------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to Created date,lead value,estimated date and area------------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                     // Filter according to Created date,lead value,estimated date and Competitior----------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Created date,lead value,estimated date,customer and area----------------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                    //Filter according to Created date,lead value,estimated date,customer and Competitior----------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to Created date,lead value,estimated date,customer,area and competitior-------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && !IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                DateValue(createdon) >= DateValue(DateFrom_11.SelectedDate) && DateValue(createdon) <= DateValue(DateTo_9.SelectedDate) && zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to lead value,estimated date-------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to lead value,customer-------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadvalue = Value(Leadvalue_2.Text) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to lead value,Area-------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadvalue = Value(Leadvalue_2.Text) && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to lead value,Competitior-------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadvalue = Value(Leadvalue_2.Text) && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                        // Filter according to lead value,estimated date and customer-------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to lead value,estimated date and Area-------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to lead value,estimated date and Competitior-------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                    // Filter according to lead value,estimated date,customer and area-------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                     // Filter according to lead value,estimated date,customer and Competitior-------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to lead value,estimated date,customer,area and Competitior-------------------------
                            IsBlank(radioStage_2.Selected) && !IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_leadvalue = Value(Leadvalue_2.Text) && zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to estimated date,customer-------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to estimated date,area-------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                             // Filter according to estimated date,Competitior-------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to estimated date,customer and area-------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to estimated date,customer and competitior-------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to estimated date,customer,area and competitior-------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) && IsBlank(DateFrom_11.SelectedDate) && !IsBlank(DateFrom_12.SelectedDate),
                            Filter(
                                offlineLeadCollection,
                                zx_expectedclosuredate <= DateValue(DateFrom_12.SelectedDate) && zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                            // Filter according to customer,area ------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && 'Owning User'.'Primary Email' = User().Email
                            ),
                             // Filter according to customer,Competitior ------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                             // Filter according to customer,area and competitior ------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && !IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_Party.'Customer Name' = radioCustomers_2.Selected.'Customer Name' && zx_Area.'Area Name' = radioArea_3.Selected.Areaname && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            ),
                             // Filter according to area and competitior ------------------------
                            IsBlank(radioStage_2.Selected) && IsBlank(Value(Leadvalue_2.Text)) && IsBlank(radioCustomers_2.Selected) && IsBlank(radioCommit_2.Selected) && !IsBlank(radioArea_3.Selected) && !IsBlank(radioCompetitor_2.Selected) || (varCreateddate = true || varEstimated = true),
                            Filter(
                                offlineLeadCollection,
                                zx_Area.'Area Name' = radioArea_3.Selected.Areaname && zx_Competitor.'Competitor Name' = radioCompetitor_2.Selected.'Competitor Name' && 'Owning User'.'Primary Email' = User().Email
                            )
                        )
                    );
                    Set(
                        varPartyFilter,
                        !varPartyFilter
                    );
                    Set(
                        varLeadFilter,
                        false
                    );
                    Set(
                        varCollectionEmpty,
                        false
                    );
                Size: |+
                    =LookUp('Environment Variable Definitions', 'Display Name'="Text Title Font Size").'Default Value'
                    //_VarGblAppFonts.Size.Title
                    
                Text: ="Apply Filters"
                Visible: =varPartyFilter
                Width: =274
                X: =366
                Y: =698
                ZIndex: =3

            ClearBtn_10 As button:
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                FontWeight: =FontWeight.Semibold
                Height: =61
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: |-
                    =ColorFade(
                        ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                    , 10%)
                OnSelect: |-
                    =Reset(DateFrom_11);
                    Reset(DateTo_9);
                    Reset(DateFrom_12);
                    Reset(radioStage_2);
                    Reset(radioCustomers_2);
                    Reset(radioCommit_2);
                    Reset(radioCompetitor_2);
                    Reset(radioArea_3);
                    Clear(colLeadFilter);
                    Clear(colFilterLeadData);
                    Set(varCreateddate,false);
                    Set(varEstimated,false);
                    Set(varCollectionEmpty,true);
                Size: =20
                Text: ="Clear Filters"
                Visible: =varPartyFilter
                Width: =274
                X: =20
                Y: =698
                ZIndex: =4

            Rectangle17_10 As rectangle:
                BorderColor: =RGBA(0, 18, 107, 1)
                Fill: =RGBA(0, 0, 0, 1)
                Height: =2
                Visible: =varPartyFilter
                Width: =640
                Y: =195
                ZIndex: =5

            Label30_28 As label:
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FontWeight: =FontWeight.Semibold
                Height: =57
                Size: =18
                Text: ="Date From"
                Visible: =If(Gallery8_10.Selected.tabid=3,true,false)
                Width: =173
                X: =331
                Y: =227
                ZIndex: =6

            DateTo_9 As datepicker:
                AccessibleLabel: ="Created To Date"
                BorderThickness: =1
                CalendarHeaderFill: =RGBA(56, 96, 178, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(255,255,255,0)
                Height: =63
                HoverDateFill: =RGBA(186, 202, 226, 1)
                IconBackground: =Color.Transparent
                IconFill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                InputTextPlaceholder: =If(IsBlank(Self.SelectedDate), Text(Today(), "dd/mm/yyyy"))
                OnChange: |
                    =If(
                        Gallery8_10.Selected.tabid = 3 && IsBlank(
                            LookUp(
                                colLeadFilter,
                                Title = "Date To"
                            ).Title
                        ),
                        Collect(
                            colLeadFilter,
                            {
                                Title: "Date To",
                                value: {
                                    Value: Text(
                                        DateTo_9.SelectedDate,
                                        "dd/mm/yyyy "
                                    )
                                }
                            }
                        ),
                        Patch(
                            colLeadFilter,
                            LookUp(
                                colLeadFilter,
                                Title = "Date To"
                            ),
                            {
                                value: {
                                    Value: Text(
                                        DateTo_9.SelectedDate,
                                        "dd/mm/yyyy "
                                    )
                                }
                            }
                        )
                    );
                OnSelect: =
                SelectedDateFill: =RGBA(56, 96, 178, 1)
                Size: =16
                Visible: =If(Gallery8_10.Selected.tabid=3,true,false)
                Width: =238
                X: =323
                Y: =426
                ZIndex: =7

            Label30_30 As label:
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FontWeight: =FontWeight.Semibold
                Height: =49
                Size: =18
                Text: ="Date To"
                Visible: =If(Gallery8_10.Selected.tabid=3,true,false)
                Width: =173
                X: =331
                Y: =377
                ZIndex: =8

            DateFrom_11 As datepicker:
                AccessibleLabel: ="Created Date From"
                BorderThickness: =1
                CalendarHeaderFill: =RGBA(56, 96, 178, 1)
                Color: =RGBA(0, 0, 0, 1)
                DefaultDate: =
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(255,255,255,0)
                Height: =63
                HoverDateFill: =RGBA(186, 202, 226, 1)
                IconBackground: =Color.Transparent
                IconFill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                InputTextPlaceholder: =If(IsBlank(Self.SelectedDate), Text(Today(), "dd/mm/yyyy"))
                OnChange: |-
                    =If(
                        Gallery8_10.Selected.tabid = 3 && IsBlank(
                            LookUp(
                                colLeadFilter,
                                Title = "Date From"
                            ).Title
                        ),
                        Collect(
                            colLeadFilter,
                            {
                                Title: "Date From",
                                value: {
                                    Value: Text(
                                        DateFrom_11.SelectedDate,
                                        "dd/mm/yyyy "
                                    )
                                }
                            }
                        ),
                        Patch(
                            colLeadFilter,
                            LookUp(
                                colLeadFilter,
                                Title = "Date From"
                            ),
                            {
                                value: {
                                    Value: Text(
                                        DateFrom_11.SelectedDate,
                                        "dd/mm/yyyy "
                                    )
                                }
                            }
                        )
                    );
                    Set(
                            varCreateddate,
                            true
                        )
                    
                        
                OnSelect: =
                SelectedDateFill: =RGBA(56, 96, 178, 1)
                Size: =16
                Visible: =If(Gallery8_10.Selected.tabid=3,true,false)
                Width: =238
                X: =322
                Y: =284
                ZIndex: =9

            Icon18_18 As icon.Cancel:
                AccessibleLabel: ="Close the Filter"
                BorderColor: =RGBA(0, 18, 107, 1)
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(244, 244, 244, 1)
                Height: =30
                Icon: =Icon.Cancel
                OnSelect: |
                    =Set(varPartyFilter,false);
                TabIndex: =0//-1
                Visible: =varPartyFilter
                Width: =30
                X: =583
                Y: =40
                ZIndex: =10

            radioStage_2 As radio:
                AccessibleLabel: ="Stages Filter"
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(0, 0, 0, 1)
                Height: =400
                HoverColor: =RGBA(0, 18, 107, 1)
                Items: =Choices('Stage Choice')
                LineHeight: =2
                OnSelect: |-
                    =If(
                        Gallery8_10.Selected.tabid = 1 && IsBlank(
                            LookUp(
                                colLeadFilter,
                                Title = Gallery8_10.Selected.Title
                            ).Title
                        ),
                        Collect(
                            colLeadFilter,
                            {
                                Title: Gallery8_10.Selected.Title,
                                value: radioStage_2.SelectedText
                            }
                        ),
                        Patch(
                            colLeadFilter,
                            LookUp(
                                colLeadFilter,
                                Title = Gallery8_10.Selected.Title
                            ),
                            {value: radioStage_2.SelectedText}
                        )
                    )
                RadioSize: =40
                Size: =16
                Visible: =If(Gallery8_10.Selected.tabid=1,true,false)
                Width: =340
                X: =300
                Y: =227
                ZIndex: =11

            radioCustomers_2 As radio:
                AccessibleLabel: ="Customer choices"
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(0, 0, 0, 1)
                Height: =466
                HoverColor: =RGBA(0, 18, 107, 1)
                Items: =OfflinePartiesCollection
                LineHeight: =2
                OnSelect: |-
                    =If(
                        Gallery8_10.Selected.tabid = 6 && IsBlank(
                            LookUp(
                                colLeadFilter,
                                Title = Gallery8_10.Selected.Title
                            ).Title
                        ),
                        Collect(
                            colLeadFilter,
                            {
                                Title: Gallery8_10.Selected.Title,
                                value: {Value: radioCustomers_2.Selected.'Customer Name'}
                            }
                        ),
                        Patch(
                            colLeadFilter,
                            LookUp(
                                colLeadFilter,
                                Title = Gallery8_10.Selected.Title
                            ),
                            {value: {Value: radioCustomers_2.Selected.'Customer Name'}}
                        )
                    )
                RadioSize: =40
                Size: =18
                Visible: =If(Gallery8_10.Selected.tabid=6,true,false)
                Width: =340
                X: =300
                Y: =210
                ZIndex: =12

            Gallery8_10 As gallery.galleryVertical:
                AccessibleLabel: ="Options onto which the Filter will be applied"
                BorderColor: =RGBA(0, 18, 107, 1)
                Height: =438
                Items: |-
                    =Table(
                        {
                            Title: "Stage",
                            tabid: 1
                        },{
                            Title: "Commit",
                            tabid: 2
                        },
                        {
                            Title: "Created Date",
                            tabid:3
                        },
                        {
                            Title: "Lead Value",
                            tabid: 4
                        },
                        {
                            Title: "Estimated Closure Date",
                            tabid: 5
                        },
                        {
                            Title: "Customer",
                            tabid: 6
                        },
                        {
                            Title: "Area",
                            tabid: 7
                        },
                        {
                            Title: "Competition",
                            tabid: 8
                        }
                    )
                Layout: =Layout.Vertical
                ShowScrollbar: =false
                TabIndex: =0//-1
                TemplateSize: =66
                Visible: =varPartyFilter
                Width: =234
                X: =36
                Y: =227
                ZIndex: =13

                Button18_11 As button:
                    Align: =Align.Left
                    Color: =RGBA(0, 0, 0, 1)
                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    Fill: |-
                        =//Color.Transparent
                        If(ThisItem.IsSelected,ColorFade(Color.DimGrey,80%),Color.Transparent)
                    FontWeight: =FontWeight.Semibold
                    Height: =61
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =ColorFade(Color.DimGrey,80%)
                    OnSelect: =
                    PaddingLeft: =25
                    PressedColor: =Color.DimGrey
                    PressedFill: =ColorFade(Color.DimGrey,80%)
                    Size: =16
                    Text: =ThisItem.Title
                    Width: =224
                    ZIndex: =1

            Label30_29 As label:
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FontWeight: =FontWeight.Semibold
                Height: =57
                Size: =18
                Text: |-
                    ="Estimated Closure Date:"
                Visible: =If(Gallery8_10.Selected.tabid=5,true,false)
                Width: =289
                X: =324
                Y: =290
                ZIndex: =15

            DateFrom_12 As datepicker:
                AccessibleLabel: ="Create From Date"
                BorderThickness: =1
                CalendarHeaderFill: =RGBA(56, 96, 178, 1)
                Color: =RGBA(0, 0, 0, 1)
                DefaultDate: =
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(255,255,255,0)
                Height: =63
                HoverDateFill: =RGBA(186, 202, 226, 1)
                IconBackground: =Color.Transparent
                IconFill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                InputTextPlaceholder: =If(IsBlank(Self.SelectedDate), Text(Today(), "dd/mm/yyyy"))
                OnChange: |-
                    =If(
                        Gallery8_10.Selected.tabid =5 && IsBlank(
                            LookUp(
                                colLeadFilter,
                                Title = "Estimated Closure Date:"
                            ).Title
                        ),
                        Collect(
                            colLeadFilter,
                            {
                                Title: "Estimated Closure Date:",
                                value: {
                                    Value: Text(
                                        DateFrom_12.SelectedDate,
                                        "dd/mm/yyyy "
                                    )
                                }
                            }
                        ),
                        Patch(
                            colLeadFilter,
                            LookUp(
                                colLeadFilter,
                                Title ="Estimated Closure Date:"
                            ),
                            {
                                value: {
                                    Value: Text(
                                        DateFrom_12.SelectedDate,
                                        "dd/mm/yyyy "
                                    )
                                }
                            }
                        )
                    );
                    Set(varEstimated,true)
                OnSelect: =
                SelectedDateFill: =RGBA(56, 96, 178, 1)
                Size: =16
                Visible: =If(Gallery8_10.Selected.tabid=5,true,false)
                Width: =238
                X: =322
                Y: =363
                ZIndex: =18

            radioCompetitor_2 As radio:
                AccessibleLabel: ="Competitors"
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(0, 0, 0, 1)
                Height: =466
                HoverColor: =RGBA(0, 18, 107, 1)
                Items: ='Competitor.S'
                LineHeight: =2
                OnSelect: |-
                    =If(
                        Gallery8_10.Selected.tabid = 8 && IsBlank(
                            LookUp(
                                colLeadFilter,
                                Title = Gallery8_10.Selected.Title
                            ).Title
                        ),
                        Collect(
                            colLeadFilter,
                            {
                                Title: Gallery8_10.Selected.Title,
                                value: {Value: Text(radioCompetitor_2.Selected.'Competitor Name')}}
                        ),
                        Patch(
                            colLeadFilter,
                            LookUp(
                                colLeadFilter,
                                Title = Gallery8_10.Selected.Title
                            ),
                            {value:{Value: radioCompetitor_2.Selected.'Competitor Name'}}
                        )
                    )
                RadioSize: =40
                Size: =18
                Visible: =If(Gallery8_10.Selected.tabid=8,true,false)
                Width: =340
                X: =300
                Y: =222
                ZIndex: =19

            radioCommit_2 As radio:
                AccessibleLabel: ="Commit options"
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(0, 0, 0, 1)
                Height: =466
                HoverColor: =RGBA(0, 18, 107, 1)
                Items: |-
                    =Choices('Commited (Leads.S)')
                    
                    //["Yes", "No"]
                LineHeight: =2
                OnSelect: |-
                    =If(
                        Gallery8_10.Selected.tabid = 2 && IsBlank(
                            LookUp(
                                colLeadFilter,
                                Title = Gallery8_10.Selected.Title
                            ).Title
                        ),
                        Collect(
                            colLeadFilter,
                            {
                                Title: Gallery8_10.Selected.Title,
                                value: radioCommit_2.SelectedText
                            }
                        ),
                        Patch(
                            colLeadFilter,
                            LookUp(
                                colLeadFilter,
                                Title = Gallery8_10.Selected.Title
                            ),
                            {value: radioCommit_2.SelectedText}
                        )
                    )
                RadioSize: =40
                Size: =18
                Visible: =If(Gallery8_10.Selected.tabid=2,true,false)
                Width: =340
                X: =297
                Y: =214
                ZIndex: =20

            radioArea_3 As radio:
                AccessibleLabel: ="Area choices"
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(0, 0, 0, 1)
                Height: =466
                HoverColor: =RGBA(0, 18, 107, 1)
                Items: |-
                    =AddColumns(
                        UserAssignedAreas,
                        "Areaname",
                        Area.'Area Name'
                    )
                LineHeight: =2
                OnSelect: |-
                    =If(
                        Gallery8_10.Selected.tabid = 7 && IsBlank(
                            LookUp(
                                colLeadFilter,
                                Title = Gallery8_10.Selected.Title
                            ).Title
                        ),
                        Collect(
                            colLeadFilter,
                            {
                                Title: Gallery8_10.Selected.Title,
                                value: {Value: radioArea_3.Selected.Areaname}}
                        ),
                        Patch(
                            colLeadFilter,
                            LookUp(
                                colLeadFilter,
                                Title = Gallery8_10.Selected.Title
                            ),
                            {value:{Value: radioArea_3.Selected.Areaname}}
                        )
                    )
                RadioSize: =40
                Size: =18
                Visible: =If(Gallery8_10.Selected.tabid=7,true,false)
                Width: =340
                X: =300
                Y: =222
                ZIndex: =21

            Leadvalue_2 As text:
                AccessibleLabel: ="Lead Value"
                Color: =RGBA(0, 0, 0, 1)
                Default: =""
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                FocusedBorderThickness: =4
                Format: =TextFormat.Number
                Height: =83
                HintText: ="Enter Lead Value"
                HoverBorderColor: =RGBA(0, 18, 107, 1)
                HoverColor: =RGBA(0, 0, 0, 1)
                HoverFill: =RGBA(186, 202, 226, 1)
                OnChange: |-
                    =If(
                        Gallery8_10.Selected.tabid = 4 && IsBlank(
                            LookUp(
                                colLeadFilter,
                                Title = Gallery8_10.Selected.Title
                            ).Title
                        ),
                        Collect(
                            colLeadFilter,
                            {
                                Title: Gallery8_10.Selected.Title,
                                value: {
                                    Value: Leadvalue_2.Text
                                }
                            }
                        ),
                        Patch(
                            colLeadFilter,
                            LookUp(
                                colLeadFilter,
                                Title =Gallery8_10.Selected.Title
                            ),
                            {
                                value: {
                                    Value:Leadvalue_2.Text
                                }
                            }
                        )
                    )
                Size: =18
                Visible: =If(Gallery8_10.Selected.tabid=4,true,false)
                Width: =218
                X: =324
                Y: =360
                ZIndex: =22

            Label27_6 As label:
                BorderColor: =RGBA(0, 18, 107, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FontWeight: =FontWeight.Bold
                Height: =66
                Size: =18
                Text: ="Lead Value"
                Visible: =If(Gallery8_10.Selected.tabid=4,true,false)
                Width: =286
                X: =323
                Y: =278
                ZIndex: =23

            Display_7 As gallery.galleryHorizontal:
                AccessibleLabel: ="Filter Applied"
                BorderColor: =RGBA(0, 18, 107, 1)
                DelayItemLoading: =true
                Height: =67
                Items: =colLeadFilter
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TabIndex: =0//-1
                TemplateSize: =250
                Visible: =If(IsBlank(varPartyFilter),false,true)
                Y: =80
                ZIndex: =24

                Button20_10 As button:
                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayMode: =DisplayMode.View
                    Fill: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
                    FontWeight: =FontWeight.Semibold
                    Height: =54
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                    RadiusBottomLeft: =15
                    RadiusBottomRight: =15
                    RadiusTopLeft: =15
                    RadiusTopRight: =15
                    Size: =24
                    Text: =""
                    Width: =246
                    X: =2
                    ZIndex: =1

                Label31_12 As label:
                    BorderColor: =RGBA(0, 18, 107, 1)
                    Color: =RGBA(255, 255, 255, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    Height: =37
                    OnSelect: =Select(Parent)
                    Size: =16
                    Text: |-
                        =ThisItem.Title & ":" & " " & ThisItem.value.Value
                    Tooltip: |-
                        =//ThisItem.Title & ":"
                    Width: =192
                    Wrap: =false
                    X: =19
                    Y: =6
                    ZIndex: =2

                Icon21_10 As icon.Cancel:
                    AccessibleLabel: ="Filter Removed"
                    BorderColor: =RGBA(0, 18, 107, 1)
                    Color: =RGBA(255, 255, 255, 1)
                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                    DisabledColor: =RGBA(244, 244, 244, 1)
                    Height: =25
                    Icon: =Icon.Cancel
                    OnSelect: |-
                        =Remove(
                            colLeadFilter,
                            ThisItem
                        );
                        Reset(radioStage_2);
                        Set(varCollectionEmpty,true);
                        Switch(
                            ThisItem.Title,
                            "Stage",
                            Reset(radioStage_2);
                            ,
                            "Commit",
                            Reset(radioCommit_2),
                            "Date From",
                            Reset(DateFrom_11);
                            Set(
                                varCreateddate,
                                false
                            ),
                            "Lead Value",
                            Reset(Leadvalue_2),
                            "Estimated Closure Date",
                            Reset(DateFrom_12);
                            Set(
                                varEstimated,
                                false
                            ),
                            "Customer",
                            Reset(radioCustomers_2),
                            "Customer",
                            Reset(radioCustomers_2),
                            "Area",
                            Reset(radioArea_3),
                            "Competitor",
                            Reset(radioCompetitor_2)
                        )
                    TabIndex: =0//-1
                    Width: =52
                    X: =196
                    Y: =14
                    ZIndex: =4

    Group6_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =20
        ZIndex: =24

        DateFilter_1 As gallery.galleryHorizontal:
            AccessibleLabel: ="Date Gallery"
            BorderColor: =RGBA(230, 230, 230, 1)
            Height: =60
            Items: |-
                =ForAll(
                    [
                        {
                            Title: "Yesterday",
                            Date: DateValue(VarvisitDate) - 1
                        },
                        {
                            Title: "Today",
                            Date: DateValue(VarvisitDate)
                        },
                        {
                            Title: "Tomorrow",
                            Date: DateValue(VarvisitDate) + 1
                        }
                    ],
                    {Value: ThisRecord}
                )
            ShowScrollbar: =false
            TabIndex: =0
            TemplatePadding: =0
            TemplateSize: =DateFilter_1.Width / 3
            Width: =App.Width - 100
            X: =50
            Y: =85
            ZIndex: =16

            Button5_11 As button:
                BorderStyle: =BorderStyle.None
                Color: |-
                    =If(ThisItem.Value.Date = ClickedPjpdate, Color.White,ColorValue(
                        LookUp(
                            c_EnvironmentVariable,
                            'Display Name' = "Button Fill"
                        ).'Default Value'))
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: |-
                    =If(ThisItem.Value.Date = ClickedPjpdate,ColorValue(
                        LookUp(
                            c_EnvironmentVariable,
                            'Display Name' = "Button Fill"
                        ).'Default Value'), ColorValue( LookUp('Environment Variable Definitions', 'Display Name'="Common Primary Background").'Default Value'))
                FontWeight: =FontWeight.Semibold
                Height: =50
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: |-
                    =ColorFade(
                        ColorValue(
                            LookUp(
                                c_EnvironmentVariable,
                                'Display Name' = "Button Fill"
                            ).'Default Value'
                        ),
                        -20%
                    )
                OnSelect: =Set(Clickedvisitdate, ThisItem.Value.Date)
                Size: =12
                Text: |-
                    =If(
                        (ThisItem.Value.Date = Today() - 1) || (ThisItem.Value.Date = Today()) || (ThisItem.Value.Date = Today() + 1),
                        ThisItem.Value.Title & " (" & Text(
                            DateValue(ThisItem.Value.Date),
                            "mmm dd"
                        ) & ")",
                        Text(
                            DateValue(ThisItem.Value.Date),
                            "mmm dd"
                        )
                    )
                Width: =170
                X: =10
                Y: =10
                ZIndex: =1

        PrevDateIcn_1 As icon.ChevronLeft:
            AccessibleLabel: ="Left Date Icon"
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =30
            Icon: =Icon.ChevronLeft
            OnSelect: =Set(VarvisitDate, DateValue(VarPjpDate) - 3)
            TabIndex: =0
            Width: =50
            Y: =100
            ZIndex: =17

        NextDateIcn_1 As icon.ChevronLeft:
            AccessibleLabel: ="Right Date Icon"
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =30
            Icon: =Icon.ChevronRight
            OnSelect: =Set(VarvisitDate, DateValue(VarPjpDate) + 3)
            TabIndex: =0
            Width: =50
            X: =590
            Y: =100
            ZIndex: =18

    Group5_1 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =27

        Image7_1 As image:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =51
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            Image: ='Vector (1)'
            OnSelect: |+
                =Set(
                    varPartyFilter,
                    !varPartyFilter
                );
                
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =If('Type Filter_1'.Selected.Id=1,true,false)
            Width: =32
            X: =561
            Y: =207
            ZIndex: =20

        Button3_2 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =47
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =
            OnSelect: |+
                =Set(
                    varPartyFilter,
                    !varPartyFilter
                );
                
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =24
            Text: =""
            Visible: =If('Type Filter_1'.Selected.Id=1,true,false)
            Width: =35
            X: =558
            Y: =209
            ZIndex: =21

