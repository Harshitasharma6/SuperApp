"'Order List View' As CanvasComponent":
    Customer: =
    DataSource: =Parties_1
    Fill: |-
        =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Screen Background Color").'Default Value')
        //_VarGblAppColors.BackgroundColor
    Height: =App.Height
    Type: ="Primary"
    varvisitid: =
    Width: =App.Width
    X: =0
    Y: =0
    ZIndex: =1

    "'Order Gallery' As gallery.galleryVertical":
        AccessibleLabel: ="Order Gallery"
        BorderColor: =RGBA(0, 18, 107, 1)
        Height: =892
        Items: |-
            =If(
                'Order List View'.Type = "Primary",
                If(
                    !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                    If(
                        IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                        Sort(
                            Switch(
                                'Filter Gallery'.Selected.Value.id,
                                3,
                                Filter(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            Visit.Visit = GUID('Order List View'.varvisitid)  && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Order Status' = 'Status Gallery'.Selected.Value
                                    ),
                                    'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                ),
                                2,
                                Filter(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Order Status' = 'Status Gallery'.Selected.Value
                                    ),
                                    'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                ),
                                1,
                                Filter(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Order Status' = 'Status Gallery'.Selected.Value
                                    ),
                                    IsToday('Created On')
                                )
                            ),
                            'Created On',
                            SortOrder.Descending
                        ),
                //For Customer-----------------------------------------------------------------
                        Sort(
                            Switch(
                                'Filter Gallery'.Selected.Value.id,
                                3,
                                Filter(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                  'Order From'.'Customer Code' = LookUp(
                                            Parties_1,
                                            'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                        ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                    ),
                                    'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                ),
                                2,
                                Filter(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Order From'.'Customer Code' = LookUp(
                                            Parties_1,
                                            'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                        ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                    ),
                                    'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                ),
                                1,
                                Filter(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Order From'.'Customer Code' = LookUp(
                                            Parties_1,
                                            'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                        ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                    ),
                                    IsToday('Created On')
                                )
                            ),
                            'Created On',
                            SortOrder.Descending
                        )
                    ),
            //////////////////////////////////////////////////////////////////////Orders Without Visits 
                    If(
                        IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                        Sort(
                            Switch(
                                'Filter Gallery'.Selected.Value.id,
                                3,
                                Filter(
                                    Filter(
                                        OfflineOrderHeaderCollection,
                                        'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary  && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                    ),
                                    'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                ),
                                2,
                                Filter(
                                    Filter(
                                        OfflineOrderHeaderCollection,
                                        'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                    ),
                                    'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                ),
                                1,
                                Filter(
                                    Filter(
                                        OfflineOrderHeaderCollection,
                                        'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                    ),
                                    IsToday('Created On')
                                )
                            ),
                            'Created On',
                            SortOrder.Descending
                        ),
                //For Customer-----------------------------------------------------------------
                        Sort(
                            Switch(
                                'Filter Gallery'.Selected.Value.id,
                                3,
                                Filter(
                                    Filter(
                                        OfflineOrderHeaderCollection,
                                        'Order From'.'Customer Code' = LookUp(
                                            Parties_1,
                                            'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                        ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                    ),
                                    'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                ),
                                2,
                                Filter(
                                    Filter(
                                        OfflineOrderHeaderCollection,
                                        'Order From'.'Customer Code' = LookUp(
                                            OfflinePartiesCollection,
                                            'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                        ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                    ),
                                    'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                ),
                                1,
                                Filter(
                                    Filter(
                                        OfflineOrderHeaderCollection,
                                        'Order From'.'Customer Code' = LookUp(
                                            OfflinePartiesCollection,
                                            'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                        ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                    ),
                                    IsToday('Created On')
                                )
                            ),
                            'Created On',
                            SortOrder.Descending
                        )
                    )
                ),
                'Order List View'.Type = "Secondary",
                If(
                    !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                    If(
                        IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                        Sort(
                            Switch(
                                'Filter Gallery'.Selected.Value.id,
                                3,
                                Filter(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            Visit.Visit = GUID('Order List View'.varvisitid) &&  'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Order Status' = 'Status Gallery'.Selected.Value
                                    ),
                                    'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                ),
                                2,
                                Filter(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Order Status' = 'Status Gallery'.Selected.Value
                                    ),
                                    'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                ),
                                1,
                                Filter(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Order Status' = 'Status Gallery'.Selected.Value
                                    ),
                                    IsToday('Created On')
                                )
                            ),
                            'Created On',
                            SortOrder.Descending
                        ),
                //For Customer-----------------------------------------------------------------
                        Sort(
                            Switch(
                                'Filter Gallery'.Selected.Value.id,
                                3,
                                Filter(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Order From'.'Customer Code' = LookUp(
                                            Parties_1,
                                            'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                        ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                    ),
                                    'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                ),
                                2,
                                Filter(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Order From'.'Customer Code' = LookUp(
                                            Parties_1,
                                            'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                        ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                    ),
                                    'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                ),
                                1,
                                Filter(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Order From'.'Customer Code' = LookUp(
                                            Parties_1,
                                            'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                        ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                    ),
                                    IsToday('Created On')
                                )
                            ),
                            'Created On',
                            SortOrder.Descending
                        )
                    ),
            //////////////////////////////////////////////////////////////////////////////////Orders Without Visits
                    If(
                        IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                        Sort(
                            Switch(
                                'Filter Gallery'.Selected.Value.id,
                                3,
                                Filter(
                                    Filter(
                                        OfflineOrderHeaderCollection,
                                        'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                    ),
                                    'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                ),
                                2,
                                Filter(
                                    Filter(
                                        OfflineOrderHeaderCollection,
                                        'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                    ),
                                    'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                ),
                                1,
                                Filter(
                                    Filter(
                                        OfflineOrderHeaderCollection,
                                        'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                    ),
                                    IsToday('Created On')
                                )
                            ),
                            'Created On',
                            SortOrder.Descending
                        ),
                //For Customer-----------------------------------------------------------------
                        Sort(
                            Switch(
                                'Filter Gallery'.Selected.Value.id,
                                3,
                                Filter(
                                    Filter(
                                        OfflineOrderHeaderCollection,
                                        'Order From'.'Customer Code' = LookUp(
                                            Parties_1,
                                            'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                        ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                    ),
                                    'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                ),
                                2,
                                Filter(
                                    Filter(
                                        OfflineOrderHeaderCollection,
                                        'Order From'.'Customer Code' = LookUp(
                                            OfflinePartiesCollection,
                                            'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                        ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                    ),
                                    'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                ),
                                1,
                                Filter(
                                    Filter(
                                        OfflineOrderHeaderCollection,
                                        'Order From'.'Customer Code' = LookUp(
                                            OfflinePartiesCollection,
                                            'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                        ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                    ),
                                    IsToday('Created On')
                                )
                            ),
                            'Created On',
                            SortOrder.Descending
                        )
                    )
                )
            )
        Layout: =Layout.Vertical
        ShowScrollbar: =false
        TabIndex: =0
        TemplateSize: =207
        Width: ='Order List View'.Width
        Y: =235
        ZIndex: =1

        Button5 As button:
            BorderColor: =Color.Black
            BorderStyle: =BorderStyle.None
            BorderThickness: =0
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Semibold
            Height: =204
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =Color.White
            OnSelect: |-
                =Navigate('Order Info',ScreenTransition.CoverRight);
                Set(varOrderData, ThisItem)
                 
            Size: =24
            Text: =""
            Width: =630
            ZIndex: =2

        Rectangle1_7 As rectangle:
            AccessibleLabel: ="Rectangle1_7"
            BorderColor: =RGBA(0, 18, 107, 1)
            Fill: =_VarGblAppColors.HeaderBg
            Height: =1
            OnSelect: |-
                =Navigate('Order Info',ScreenTransition.CoverRight);
                Set(varOrderData, ThisItem)
                 
            TabIndex: =0
            Width: ='Order Gallery'.TemplateWidth
            Y: =74
            ZIndex: =3

        Background_14 As button:
            BorderThickness: =0
            Color: =ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Hover Color").'Default Value')
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(116, 116, 116, 1)
            DisabledFill: =_VarGblAppColors.BottomListBg
            DisplayMode: =DisplayMode.Disabled
            Fill: =_VarGblAppColors.BottomListBg
            FontWeight: =FontWeight.Semibold
            Height: =55
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: |-
                =Navigate('Order Info',ScreenTransition.CoverRight);
                Set(varOrderData, ThisItem)
                 
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =24
            Text: =""
            Width: ='Order Gallery'.TemplateWidth 
            Y: =149
            ZIndex: =4

        Body1_29 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =_VarGblAppColors.PrimaryRed
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =1
            Font: =_VarGblAppFonts.Heading
            FontWeight: =FontWeight.Bold
            Height: =75
            OnSelect: |-
                =Navigate('Order Info',ScreenTransition.CoverRight);
                Set(varOrderData, ThisItem)
                 
            Size: =20
            TabIndex: =0
            Text: = ThisItem.'Order ID'
            Tooltip: ="Order No." & ThisItem.'Order ID'
            Width: =290
            Wrap: =false
            X: =20
            ZIndex: =5

        Body1_30 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =_VarGblAppColors.PrimaryRed
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =01
            Font: =_VarGblAppFonts.Heading
            FontWeight: =FontWeight.Bold
            Height: =75
            OnSelect: |-
                =Navigate('Order Info',ScreenTransition.CoverRight);
                Set(varOrderData, ThisItem)
                 
            Size: =_VarGblAppFonts.Size.Medium
            TabIndex: =0
            Text: |-
                =Text(DateTimeValue( ThisItem.'Created On'), "dd/mm/yyyy hh:mm AM/PM")
            Tooltip: |-
                =Text(DateTimeValue( ThisItem.'Created On'), "dd/mm/yyyy hh:mm AM/PM")
            Width: =310
            Wrap: =false
            X: =320
            ZIndex: =6

        Body1_31 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =01
            Font: =_VarGblAppFonts.Heading
            FontWeight: =FontWeight.Semibold
            Height: =75
            OnSelect: |-
                =Navigate('Order Info',ScreenTransition.CoverRight);
                Set(varOrderData, ThisItem)
                 
            Size: =_VarGblAppFonts.Size.Subtitle
            TabIndex: =0
            Text: |-
                ="Order Status: " & ThisItem.'Order Status'
            Tooltip: |-
                ="Order Status: " & ThisItem.Status
            Width: =290
            Wrap: =false
            X: =321
            Y: =75
            ZIndex: =7

        Body1_34 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =01
            Font: =_VarGblAppFonts.Heading
            FontWeight: =FontWeight.Semibold
            Height: =74
            OnSelect: |-
                =Navigate('Order Info',ScreenTransition.CoverRight);
                Set(varOrderData, ThisItem)
                 
            Size: =_VarGblAppFonts.Size.Subtitle
            TabIndex: =0
            Text: |-
                ="Order From: " & ThisItem.'Order From'.'Customer Name'
            Tooltip: |-
                ="Order To: " & ThisItem.'Order To'.'Customer Name'
            Width: =290
            X: =20
            Y: =75
            ZIndex: =10

        Body1_35 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =1
            Font: =_VarGblAppFonts.Heading
            FontWeight: =FontWeight.Semibold
            Height: =55
            OnSelect: |-
                =Navigate('Order Info',ScreenTransition.CoverRight);
                Set(varOrderData, ThisItem)
                 
            Size: =_VarGblAppFonts.Size.Subtitle
            TabIndex: =0
            Text: |-
                ="Total Bill Amount: " &"₹"&ThisItem.'Total Bill Amount'
            Tooltip: |-
                ="Total Bill Amount: " &"₹"&ThisItem.'Total Bill Amount'
            Width: =290
            X: =321
            Y: =149
            ZIndex: =11

        Body1_42 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =1
            Font: =_VarGblAppFonts.Heading
            FontWeight: =FontWeight.Semibold
            Height: =55
            OnSelect: |-
                =Navigate('Order Info',ScreenTransition.CoverRight);
                Set(varOrderData, ThisItem)
                 
            Size: =_VarGblAppFonts.Size.Subtitle
            TabIndex: =0
            Text: |-
                ="Total Tax: " & "₹" & If(
                    IsBlank(
                        Sum(
                            ThisItem.CGST,
                            ThisItem.SGST,
                            ThisItem.IGST
                        )
                    ),
                    0,
                    Sum(
                        ThisItem.CGST,
                        ThisItem.SGST,
                        ThisItem.IGST
                    )
                )
            Tooltip: |-
                =
                "Total Tax: " &"₹"& Sum(ThisItem.CGST,ThisItem.SGST,ThisItem.IGST)
            Width: =290
            X: =20
            Y: =149
            ZIndex: =12

    "'Filter Gallery' As gallery.galleryHorizontal":
        AccessibleLabel: ="Filter Gallery"
        BorderColor: =RGBA(0, 18, 107, 1)
        FocusedBorderThickness: =01
        Height: =125
        Items: |-
            =ForAll([
                {
                    id: 1,
                    Title: "Today's Orders",
                    Value: If(
                        'Order List View'.Type = "Primary",
                        If(
                            !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        IsToday('Created On')
                                    ),
                                    'Total Bill Amount'
                                ),
                //For Customer-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order From'.'Customer Code' = LookUp(
                                                Parties_1,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        IsToday('Created On')
                                    ),
                                    'Total Bill Amount'
                                )
                            ),
            //////////////////////////////////////////////////////////////////////Orders Without Visits 
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        IsToday('Created On')
                                    ),
                                    'Total Bill Amount'
                                ),
                //For Customer-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order From'.'Customer Code' = LookUp(
                                                OfflinePartiesCollection,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        IsToday('Created On')
                                    ),
                                    'Total Bill Amount'
                                )
                            )
                        ),
                        'Order List View'.Type = "Secondary",
                        If(
                            !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        IsToday('Created On')
                                    ),
                                    'Total Bill Amount'
                                ),
                //For Customer-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order From'.'Customer Code' = LookUp(
                                                Parties_1,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        IsToday('Created On')
                                    ),
                                    'Total Bill Amount'
                                )
                            ),
            //////////////////////////////////////////////////////////////////////////////////Orders Without Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        IsToday('Created On')
                                    ),
                                    'Total Bill Amount'
                                ),
                //For Customer-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order From'.'Customer Code' = LookUp(
                                                OfflinePartiesCollection,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        IsToday('Created On')
                                    ),
                                    'Total Bill Amount'
                                )
                            )
                        )
                    ),
                    //COUNT____________________________________________________________________________________________________________________--
                    Count: If(
                        'Order List View'.Type = "Primary",
                        If(
                            !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        IsToday('Created On')
                                    )
                                ),
                //For Customer-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order From'.'Customer Code' = LookUp(
                                                Parties_1,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        IsToday('Created On')
                                    )
                                )
                            ),
            //////////////////////////////////////////////////////////////////////Orders Without Visits 
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        IsToday('Created On')
                                    )
                                ),
                //For Customer-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order From'.'Customer Code' = LookUp(
                                                OfflinePartiesCollection,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        IsToday('Created On')
                                    )
                                )
                            )
                        ),
                        'Order List View'.Type = "Secondary",
                        If(
                            !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        IsToday('Created On')
                                    )
                                ),
                //For Customer-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order From'.'Customer Code' = LookUp(
                                                Parties_1,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        IsToday('Created On')
                                    )
                                )
                            ),
            //////////////////////////////////////////////////////////////////////////////////Orders Without Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        IsToday('Created On')
                                    )
                                ),
                //For Customer-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order From'.'Customer Code' = LookUp(
                                                OfflinePartiesCollection,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        IsToday('Created On')
                                    )
                                )
                            )
                        )
                    )
                },
                //________________________________________________________________________________________________________________________________________
                {
                    id: 2,
                    Title: "Last 7 Days",
                    Value: If(
                        'Order List View'.Type = "Primary",
                        If(
                            !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                ),
                //For Customer-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order From'.'Customer Code' = LookUp(
                                                Parties_1,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                )
                            ),
            //////////////////////////////////////////////////////////////////////Orders Without Visits 
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                ),
                //For Customer-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order From'.'Customer Code' = LookUp(
                                                OfflinePartiesCollection,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                )
                            )
                        ),
                        'Order List View'.Type = "Secondary",
                        If(
                            !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                ),
                //For Customer-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order From'.'Customer Code' = LookUp(
                                                Parties_1,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                )
                            ),
            //////////////////////////////////////////////////////////////////////////////////Orders Without Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                ),
                //For Customer-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order From'.'Customer Code' = LookUp(
                                                OfflinePartiesCollection,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                )
                            )
                        )
                    ),
                    //_______________________________________________________________________COUNT____________________________________________________
                    Count: If(
                        'Order List View'.Type = "Primary",
                        If(
                            !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    )
                                ),
                //For Customer-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order From'.'Customer Code' = LookUp(
                                                Parties_1,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    )
                                )
                            ),
            //////////////////////////////////////////////////////////////////////Orders Without Visits 
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    )
                                ),
                //For Customer-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order From'.'Customer Code' = LookUp(
                                                OfflinePartiesCollection,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    )
                                )
                            )
                        ),
                        'Order List View'.Type = "Secondary",
                        If(
                            !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    )
                                ),
                //For Customer-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order From'.'Customer Code' = LookUp(
                                                Parties_1,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    )
                                )
                            ),
            //////////////////////////////////////////////////////////////////////////////////Orders Without Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    )
                                ),
                //For Customer-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order From'.'Customer Code' = LookUp(
                                                OfflinePartiesCollection,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 7)&& Not( IsToday('Created On'))
                                    )
                                )
                            )
                        )
                    )
                },
                {
                    id: 3,
                    Title: "Last 30 Days",
                    Value: If(
                        'Order List View'.Type = "Primary",
                        If(
                            !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                ),
                //For Customer-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order From'.'Customer Code' = LookUp(
                                                Parties_1,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                )
                            ),
            //////////////////////////////////////////////////////////////////////Orders Without Visits 
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                ),
                //For Customer-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order From'.'Customer Code' = LookUp(
                                                OfflinePartiesCollection,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                )
                            )
                        ),
                        'Order List View'.Type = "Secondary",
                        If(
                            !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                ),
                //For Customer-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order From'.'Customer Code' = LookUp(
                                                Parties_1,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                )
                            ),
            //////////////////////////////////////////////////////////////////////////////////Orders Without Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                ),
                //For Customer-----------------------------------------------------------------
                                Sum(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order From'.'Customer Code' = LookUp(
                                                OfflinePartiesCollection,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    ),
                                    'Total Bill Amount'
                                )
                            )
                        )
                    ),
                    Count: If(
                        'Order List View'.Type = "Primary",
                        If(
                            !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    )
                                ),
                //For Customer-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order From'.'Customer Code' = LookUp(
                                                Parties_1,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    )
                                )
                            ),
            //////////////////////////////////////////////////////////////////////Orders Without Visits 
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    )
                                ),
                //For Customer-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order From'.'Customer Code' = LookUp(
                                                OfflinePartiesCollection,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Primary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    )
                                )
                            )
                        ),
                        'Order List View'.Type = "Secondary",
                        If(
                            !IsBlank('Order List View'.varvisitid),
            //////////////////////////////////////////////////////////////////////////////////Orders with Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    )
                                ),
                //For Customer-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            Filter(
                                                OfflineOrderHeaderCollection,
                                                Visit.Visit = GUID('Order List View'.varvisitid) && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                            ),
                                            'Order From'.'Customer Code' = LookUp(
                                                Parties_1,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    )
                                )
                            ),
            //////////////////////////////////////////////////////////////////////////////////Orders Without Visits
                            If(
                                IsBlank('Order List View'.Customer),
                //For Order Page-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    )
                                ),
                //For Customer-----------------------------------------------------------------
                                CountRows(
                                    Filter(
                                        Filter(
                                            OfflineOrderHeaderCollection,
                                            'Order From'.'Customer Code' = LookUp(
                                                OfflinePartiesCollection,
                                                'Parties (new_partiesid)' = 'Order List View'.Customer.new_partiesid
                                            ).'Customer Code' && 'Order Status' = 'Status Gallery'.Selected.Value && 'Order Type' = 'Order Type Choice'.Secondary && 'Owning User'.'Primary Email' = ComboBox2_2.Selected.'Primary Email'
                                        ),
                                        'Created On' > (Today() - 30)&& Not( IsToday('Created On'))
                                    )
                                )
                            )
                        )
                    )
                }
            ], {Value: ThisRecord})
        ShowScrollbar: =false
        TabIndex: =0
        TemplateSize: =201
        Width: =623
        X: =12
        Y: =6
        ZIndex: =2

        Button7 As button:
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: |-
                =If(ThisItem.IsSelected, ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )//_VarGblAppColors.PrimaryRed
                ,
                ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Common Primary Background").'Default Value' )
                //_VarGblAppColors.PrimaryBg
                
                )
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Height: =105
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =Self.Fill
            OnSelect: =Select(Parent)
            Size: =14
            Text: =ThisItem.Value.Title
            VerticalAlign: =VerticalAlign.Top
            Width: =195
            ZIndex: =2

        Label25 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Semibold
            Height: =33
            OnSelect: =Select(Parent)
            Size: =12
            Text: |-
                ="Value: ₹" & ThisItem.Value.Value
            Width: =195
            Y: =36
            ZIndex: =3

        Label25_1 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Semibold
            Height: =33
            OnSelect: =Select(Parent)
            Size: =12
            Text: |-
                ="Count: " & ThisItem.Value.Count
            Width: =195
            Y: =65
            ZIndex: =4

    "'Status Gallery' As gallery.galleryHorizontal":
        AccessibleLabel: ="Status Gallery"
        BorderColor: =RGBA(0, 18, 107, 1)
        Height: =45
        Items: =Choices('Order Status Choice')
        ShowScrollbar: =false
        TabIndex: =0
        TemplateSize: =162
        Width: ='Order List View'.Width
        Y: =122
        ZIndex: =3

        Button7_1 As button:
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: |-
                =If(ThisItem.IsSelected,ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Button Fill").'Default Value' )// _VarGblAppColors.PrimaryRed
                ,ColorFade(
                    ColorValue(LookUp(c_EnvironmentVariable,'Display Name'="Common Primary Background").'Default Value' )//_VarGblAppColors.PrimaryBg
                    ,20%))
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Height: =35
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: =Select(Parent)
            Size: =12
            Text: =ThisItem.Value
            Width: =159
            ZIndex: =2

    ComboBox2_2 As combobox:
        AccessibleLabel: ="Salesperson ComboBox"
        BorderColor: =RGBA(179, 179, 179, 1)
        BorderThickness: =1
        ChevronBackground: =RGBA(0, 0, 0, 0)
        ChevronDisabledBackground: =RGBA(166, 166, 166, 1)
        ChevronDisabledFill: =RGBA(244, 244, 244, 1)
        ChevronFill: =_VarGblAppColors.PrimaryRed
        ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        ChevronHoverFill: =RGBA(255, 255, 255, 1)
        Default: =LookUp(Users,'Primary Email'=User().Email)
        DefaultSelectedItems: =LookUp(Users,'Primary Email'=User().Email)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(0, 0, 0, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        DisplayFields: =["fullname"]
        DisplayMode: |-
            =//DisplayMode.Edit
            If(IsBlank(LookUp(Users,Manager.'Primary Email'= User().Email)),DisplayMode.Disabled,DisplayMode.Edit)
        Height: =55
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(186, 202, 226, 1)
        InputTextPlaceholder: ="Search Users"
        Items: =Filter(Users,Manager.'Primary Email'= User().Email || 'Primary Email'= User().Email)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(0, 18, 107, 1)
        SearchFields: =["fullname"]
        SearchItems: =Search(Filter(Users,Manager.'Primary Email'= User().Email || 'Primary Email'= User().Email),ComboBox2_2.SearchText,"fullname")
        SelectionFill: =RGBA(56, 96, 178, 1)
        SelectMultiple: =false
        Size: =21
        Width: ='Order List View'.Width-20
        X: =10
        Y: =173
        ZIndex: =4

