"'Visit List View_1' As CanvasComponent":
    DataSource: =
    Fill: =RGBA(237, 237, 237, 1)
    Height: =App.Height - 180
    VisitDate: |-
        =//Now()
        Today()
    Width: =640
    X: =0
    Y: =0
    ZIndex: =1

    Gallery1_2 As gallery.galleryVertical:
        AccessibleLabel: ="List View"
        BorderColor: =RGBA(0, 18, 107, 1)
        BorderStyle: =BorderStyle.None
        Height: =Parent.Height
        Items: |-
            =/*SortByColumns(
                Sort(
                   // Filter(
                    Filter(
                        OfflineVisitCollection,
                        zx_visitdate >= 'Visit List View'.VisitDate && 'Owning User'.'Primary Email' = ComboBox2_1.Selected.'Primary Email
                    ),
                       // IsToday('Created On')
                   // ),
                    createdon,
                    SortOrder.Descending
                ),
                "zx_visitstatus",
                [
                    [@'Visit Status'].Started,
                    [@'Visit Status'].'Not Started',
                    [@'Visit Status'].Completed
                ]
            )*/
            Sort(Filter(
                OfflineVisitCollection,
                DateValue('Visit date') >= 'Visit List View_1'.VisitDate 
            ),'Created On',SortOrder.Descending)
        Layout: =Layout.Vertical
        ShowScrollbar: =false
        TabIndex: =
        TemplatePadding: =10
        TemplateSize: =280
        Y: =5
        ZIndex: =1

        Background_3 As button:
            BorderColor: =RGBA(0, 121, 187, 1)
            BorderThickness: =1
            Color: =_VarGblAppColors.AccentBg
            DisabledBorderColor: =RGBA(102, 182, 227, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =_VarGblAppColors.AccentBg
            DisplayMode: =DisplayMode.Disabled
            Fill: =RGBA(56, 96, 178, 1)
            FontWeight: =FontWeight.Semibold
            Height: =275
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: =Select(Parent)
            RadiusBottomLeft: =15
            RadiusBottomRight: =15
            RadiusTopLeft: =15
            RadiusTopRight: =15
            Size: =24
            Text: =""
            Width: =600
            X: =10
            ZIndex: =1

        TitleLbl_2 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Bold
            Height: =30
            LineHeight: =1
            OnSelect: =Select(Parent)
            Size: =16
            Text: =ThisItem.Party.'Customer Name'
            Width: =300
            X: =77
            Y: =20
            ZIndex: =2

        Title2Lbl_2 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =_VarGblAppColors.PrimaryRed
            DisabledColor: =RGBA(166, 166, 166, 1)
            Font: =Font.'Segoe UI'
            Height: =35
            LineHeight: =1
            OnSelect: =Select(Parent)
            Size: =13
            Text: =ThisItem.Party.Address
            Width: =360
            X: =77
            Y: =45
            ZIndex: =3

        Circle6_2 As circle:
            BorderColor: =RGBA(102, 182, 227, 1)
            BorderThickness: =1
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            OnSelect: |-
                =Launch("tel://" & ThisItem.zx_Party.'Mobile No.')
            Width: =50
            X: =431
            Y: =18
            ZIndex: =6

        Icon3_3 As icon.Phone:
            AccessibleLabel: ="Icon3_1"
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =_VarGblAppColors.PrimaryRed
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =35
            Icon: =Icon.Waypoint
            OnSelect: |-
                =Launch("http://www.google.com/maps/place/" & ThisItem.zx_Party.Latitude &"," & ThisItem.zx_Party.Longitude)
            PaddingLeft: =5
            PaddingRight: =5
            TabIndex: =0
            Width: =37
            X: =496
            Y: =25
            ZIndex: =7

        Icon3_2 As icon.Phone:
            AccessibleLabel: ="Icon3"
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =_VarGblAppColors.PrimaryRed
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =37
            Icon: =Icon.Phone
            OnSelect: |-
                =Launch("tel://" & ThisItem.zx_Party.'Mobile No.')
            PaddingLeft: =5
            PaddingRight: =5
            TabIndex: =0
            Width: =37
            X: =436
            Y: =25
            ZIndex: =8

        Circle6_3 As circle:
            BorderColor: =RGBA(102, 182, 227, 1)
            BorderThickness: =1
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            OnSelect: |-
                =Launch("http://www.google.com/maps/place/" & ThisItem.zx_Party.Latitude &"," & ThisItem.zx_Party.Longitude)
            Width: =50
            X: =489
            Y: =18
            ZIndex: =9

        Circle7_1 As circle:
            BorderColor: =RGBA(102, 182, 227, 1)
            BorderThickness: =1
            DisplayMode: |-
                =If(
                    LookUp(
                        OfflineVisitCollection,
                        zx_visitid = ThisItem.zx_visitid
                    ).zx_visitstatus = 'Visit Status'.Completed,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            OnSelect: =
            Width: =50
            X: =549
            Y: =18
            ZIndex: =10

        Image15_1 As image:
            BorderColor: =RGBA(0, 18, 107, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            DisplayMode: |-
                =If(
                    LookUp(
                        OfflineVisitCollection,
                        zx_visitid = ThisItem.zx_visitid
                    ).zx_visitstatus = 'Visit Status'.Completed,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Height: =30
            Image: |-
                =/*If(Endbtvisible = false,
                'play-buttton','call-end')*/
                //'play-buttton'
                If(ThisItem.zx_visitstatus = 'Visit Status'.Started , square , 'play (1)')
            OnSelect: |
                =If(
                    Self.Image = 'play (1)',
                    (If(
                        ThisItem.createdby.'Primary Email' = User().Email,
                        If(
                            CountIf(
                                Attendances,
                                User.'Primary Email' = User().Email && Date = Today() && !IsBlank('Check-out Time')
                            ) > 0,
                            Notify(
                                "Your day has Ended, you can not start Visit",
                                NotificationType.Error,
                                2000
                            ),
                            If(
                                CountIf(
                                    Attendances,
                                    User.'Primary Email' = User().Email && Date = Today() && !IsBlank('Check-in Time')
                                ) = 0,
                                Notify(
                                    "Kindly Start your day first",
                                    NotificationType.Error,
                                    2000
                                );
                                Navigate(Home),
                                If(
                                    Not(
                                        Text(
                                            ThisItem.zx_visitdate,
                                            "dd/mm/yyyy"
                                        ) = Text(
                                            Today(),
                                            "dd/mm/yyyy"
                                        )
                                    ),
                                    Notify(
                                        "Visit cannot be started",
                                        NotificationType.Error,
                                        2000
                                    ),
                                    IsBlank(
                                        LookUp(
                                            OfflineVisitCollection,
                                            zx_visitdate = Today() && createdby.'Primary Email' = User().Email && zx_visitstatus = [@'Visit Status'].Started && Not(zx_visitid = ThisItem.zx_visitid)
                                        )
                                    ),
                                    If(
                                        Connection.Connected,
                                        Patch(
                                            'Visit.S',
                                            LookUp(
                                                'Visit.S',
                                                Visit = ThisItem.zx_visitid
                                            ),
                                            {
                                                'Visit Status': 'Visit Status'.Started,
                                                'Check-in Time': Now(),
                                                'Check-in Geo Location Lat': Location.Latitude,
                                                'Check-in Geo Location Long': Location.Longitude,
                                                'Check-in Address': LookUp(
                                                    'Parties.S',
                                                    Address = ThisItem.zx_Party.Address
                                                ).Address
                                            }
                                        );
                                        Notify(
                                            "Visit has been started",
                                            NotificationType.Success,
                                            700
                                        );
                                        ,
                                        Collect(
                                            OfflineVisitsToBeSynced,
                                            {
                                                visitItem: LookUp(
                                                    OfflineVisitCollection,
                                                    zx_visitid = ThisItem.zx_visitid
                                                ),
                                                visitGUID: ThisItem.zx_visitid,
                                                status: 'Visit Status'.Started,
                                                'Check-in Time': Now(),
                                                'Check-in Geo Location Lat': Location.Latitude,
                                                'Check-in Geo Location Long': Location.Longitude,
                                                'Check-in Address': LookUp(
                                                    'Parties.S',
                                                    Address = ThisItem.zx_Party.Address
                                                ).Address
                                            }
                                        );
                                        Patch(
                                            OfflineVisitCollection,
                                            LookUp(
                                                OfflineVisitCollection,
                                                zx_visitid = ThisItem.zx_visitid
                                            ),
                                            {
                                                zx_visitstatus: 'Visit Status'.Started,
                                                zx_checkintime: Now(),
                                                zx_checkingeolocationlat: Location.Latitude,
                                                zx_checkingeolocationlong: Location.Longitude,
                                                zx_checkinaddress: LookUp(
                                                    'Parties.S',
                                                    Address = ThisItem.zx_Party.Address
                                                ).Address
                                            }
                                        );
                                        SaveData(
                                            OfflineVisitsToBeSynced,
                                            "OfflineVisitsToBeSynced"
                                        );
                                        Notify(
                                            "Data has been saved on local",
                                            NotificationType.Success,
                                            1000
                                        );
                                    );
                                    Set(
                                        _VarActivetopTabID,
                                        1
                                    );
                                    Navigate(
                                        'Visit Info',
                                        ScreenTransition.CoverRight
                                    );
                                    Set(
                                        dataVisit,
                                        ThisItem
                                    );
                                    Set(
                                        _varClickedVisitAccount,
                                        ThisItem.zx_Party.Parties
                                    );
                                    Set(
                                        _varCustomerforDiscount,
                                        ThisItem.zx_Party.Parties
                                    );
                                //Set attached dist according_______________________________________________________________
                If(
                                        ThisItem.zx_Party.'Customer Type' = 'Party Type Choices'.Retailer,
                                        Set(
                                            _varSelectedRetailerAttachedDistributor,
                                            LookUp(
                                                OfflinePartiesCollection,
                                                zx_customercode = ThisItem.zx_Party.'Customer Code'
                                            ).zx_AttachedDistributor.Parties
                                        );
                                        ,
                                        Set(
                                            _varSelectedRetailerAttachedDistributor,
                                            Blank()
                                        )
                                    );
                                    Set(
                                        _varVisitId,
                                        ThisItem.zx_visitid
                                    );
                                    ,
                                    Notify(
                                        "One Visit is Already Started.",
                                        NotificationType.Warning,
                                        1000
                                    )
                                )
                            )
                        );
                        ,
                        Notify(
                            "You cannot start the subordinate visit",
                            NotificationType.Error,
                            2000
                        )
                    ));
                    ,
                    Patch(
                        OfflineVisitCollection,
                        LookUp(
                            OfflineVisitCollection,
                            zx_visitid = ThisItem.zx_visitid
                        ),
                        {
                            zx_visitstatus: 'Visit Status'.Completed,
                            zx_checkoutaddress: Concatenate(
                                Location.Latitude,
                                ",",
                                Location.Longitude
                            ),
                            zx_checkouttime: Now()
                        }
                    );
                    Notify(
                        "Your visit has been successfully ended.",
                        NotificationType.Success,
                        2500
                    );
                    
                );
                ClearCollect(
                    OfflineVisitCollection,
                    'Visit.S'
                );
            Width: =30
            X: =560
            Y: =27
            ZIndex: =11

        Circle8_1 As circle:
            BorderColor: =RGBA(0, 18, 107, 1)
            BorderStyle: =BorderStyle.None
            BorderThickness: =1
            Fill: =_VarGblAppColors.PrimaryRed
            Height: =45
            OnSelect: =Select(Parent)
            Width: =45
            X: =25
            Y: =22
            ZIndex: =12

        Label48_1 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Semibold
            Height: =30
            OnSelect: =Select(Parent)
            Text: =Left(Upper(ThisItem.zx_Party.'Customer Name'),1)
            Width: =30
            X: =32
            Y: =30
            ZIndex: =13

        Rectangle30_1 As rectangle:
            BorderColor: =RGBA(0, 18, 107, 1)
            Fill: =RGBA(102, 182, 227, 1)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =600
            X: =10
            Y: =85
            ZIndex: =14

        Label30_3 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Height: =35
            OnSelect: =Select(Parent)
            PaddingLeft: =0
            Text: ="Last Visit Summary"
            Width: =260
            X: =44
            Y: =104
            ZIndex: =15

        Label30_4 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Height: =35
            OnSelect: =Select(Parent)
            Text: ="Booking History"
            Width: =200
            X: =378
            Y: =104
            ZIndex: =16

        Label65_2 As label:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Height: =27
            OnSelect: =Select(Parent)
            Text: |-
                =Text(
                    LookUp(
                        Sort(
                           OfflineVisitCollection,
                            zx_visitdate,
                            SortOrder.Descending
                        ),
                        zx_Party.Parties = ThisItem.zx_Party.Parties && 'Visit Status' = ThisItem.'Visit Status'
                    ).zx_visitdate,
                    "dd/mm/yyyy"
                )
            Width: =200
            X: =88
            Y: =141
            ZIndex: =23

